Title: Python Library Updates
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section outlines various updates and bug fixes in the Python library, including preventing exceptions with site.main() when PYTHONSTARTUP is set, treating certain datetime instances as naive, avoiding race conditions with debug logging, and modifying sequence operations on mmap objects to raise TypeError instead of SystemError.
---

### Library[¶](https://docs.python.org/3/whatsnew/changelog.html#id571 "Link to this heading")
  * [bpo-30167](https://bugs.python.org/issue?@action=redirect&bpo=30167): Prevent site.main() exception if PYTHONSTARTUP is set. Patch by Steve Weber.
  * [bpo-33812](https://bugs.python.org/issue?@action=redirect&bpo=33812): Datetime instance d with non-None tzinfo, but with d.tzinfo.utcoffset(d) returning None is now treated as naive by the astimezone() method.
  * [bpo-30805](https://bugs.python.org/issue?@action=redirect&bpo=30805): Avoid race condition with debug logging
  * [bpo-33767](https://bugs.python.org/issue?@action=redirect&bpo=33767): The concatenation (`+`) and repetition (`*`) sequence operations now raise [`TypeError`](https://docs.python.org/3/library/exceptions.html#TypeError "TypeError") instead of [`SystemError`](https://docs.python.org/3/library/exceptions.html#SystemError "SystemError") when performed on [`mmap.mmap`](https://docs.python.org/3/library/mmap.html#mmap.mmap "mmap.mmap") objects. Patch by Zackery Spytz.
  * [bpo-32684](https://bugs.python.org/issue?@action=redirect&bpo=32684): Fix gather to propagate cancellation of itself even with return_exceptions.
  * [bpo-33674](https://bugs.python.org/issue?@action=redirect&bpo=33674): Fix a race condition in SSLProtocol.connection_made() of asyncio.sslproto: start immediately the handshake instead of using call_soon(). Previously, data_received() could be called before the handshake started, causing the handshake to hang or fail.
  * [bpo-31647](https://bugs.python.org/issue?@action=redirect&bpo=31647): Fixed bug where calling write_eof() on a _SelectorSocketTransport after it’s already closed raises AttributeError.
  * [bpo-33672](https://bugs.python.org/issue?@action=redirect&bpo=33672): Fix Task.__repr__ crash with Cython’s bogus coroutines
  * [bpo-33469](https://bugs.python.org/issue?@action=redirect&bpo=33469): Fix RuntimeError after closing loop that used run_in_executor
  * [bpo-11874](https://bugs.python.org/issue?@action=redirect&bpo=11874): Use a better regex when breaking usage into wrappable parts. Avoids bogus assertion errors from custom metavar strings.
  * [bpo-30877](https://bugs.python.org/issue?@action=redirect&bpo=30877): Fixed a bug in the Python implementation of the JSON decoder that prevented the cache of parsed strings from clearing after finishing the decoding. Based on patch by c-fos.
  * [bpo-33548](https://bugs.python.org/issue?@action=redirect&bpo=33548): tempfile._candidate_tempdir_list should consider common TEMP locations
  * [bpo-33542](https://bugs.python.org/issue?@action=redirect&bpo=33542): Prevent `uuid.get_node` from using a DUID instead of a MAC on Windows. Patch by Zvi Effron
  * [bpo-26819](https://bugs.python.org/issue?@action=redirect&bpo=26819): Fix race condition with `ReadTransport.resume_reading` in Windows proactor event loop.
  * [bpo-28556](https://bugs.python.org/issue?@action=redirect&bpo=28556): Minor fixes in typing module: add annotations to `NamedTuple.__new__`, pass `*args` and `**kwds` in `Generic.__new__`. Original PRs by Paulius Šarka and Chad Dombrova.
  * [bpo-20087](https://bugs.python.org/issue?@action=redirect&bpo=20087): Updated alias mapping with glibc 2.27 supported locales.
  * [bpo-33422](https://bugs.python.org/issue?@action=redirect&bpo=33422): Fix trailing quotation marks getting deleted when looking up byte/string literals on pydoc. Patch by Andrés Delfino.
  * [bpo-33197](https://bugs.python.org/issue?@action=redirect&bpo=33197): Update error message when constructing invalid inspect.Parameters Patch by Donghee Na.
  * [bpo-33383](https://bugs.python.org/issue?@action=redirect&bpo=33383): Fixed crash in the get() method of the [`dbm.ndbm`](https://docs.python.org/3/library/dbm.html#module-dbm.ndbm "dbm.ndbm: The New Database Manager \(Unix\)") database object when it is called with a single argument.
  * [bpo-33329](https://bugs.python.org/issue?@action=redirect&bpo=33329): Fix multiprocessing regression on newer glibcs
  * [bpo-991266](https://bugs.python.org/issue?@action=redirect&bpo=991266): Fix quoting of the `Comment` attribute of [`http.cookies.SimpleCookie`](https://docs.python.org/3/library/http.cookies.html#http.cookies.SimpleCookie "http.cookies.SimpleCookie").
  * [bpo-33131](https://bugs.python.org/issue?@action=redirect&bpo=33131): Upgrade bundled version of pip to 10.0.1.
  * [bpo-33308](https://bugs.python.org/issue?@action=redirect&bpo=33308): Fixed a crash in the `parser` module when converting an ST object to a tree of tuples or lists with `line_info=False` and `col_info=True`.
  * [bpo-33263](https://bugs.python.org/issue?@action=redirect&bpo=33263): Fix FD leak in `_SelectorSocketTransport` Patch by Vlad Starostin.
  * [bpo-33256](https://bugs.python.org/issue?@action=redirect&bpo=33256): Fix display of `<module>` call in the html produced by `cgitb.html()`. Patch by Stéphane Blondon.
  * [bpo-33203](https://bugs.python.org/issue?@action