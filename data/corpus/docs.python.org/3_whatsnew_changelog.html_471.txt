Title: Python 3 Changelog Highlights
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This update addresses a crash in subinterpreter finalization related to daemon threads and includes bug fixes for the `pickle` module, incomplete data decompression in `lzma`, and corrections in the `RobotFileParser` methods.
---

Previously, the subinterpreter finalization crashed with a Python fatal error if a daemon thread was still running.
  * [bpo-37210](https://bugs.python.org/issue?@action=redirect&bpo=37210): Allow pure Python implementation of [`pickle`](https://docs.python.org/3/library/pickle.html#module-pickle "pickle: Convert Python objects to streams of bytes and back.") to work even when the C `_pickle` module is unavailable.
  * [bpo-21872](https://bugs.python.org/issue?@action=redirect&bpo=21872): Fix [`lzma`](https://docs.python.org/3/library/lzma.html#module-lzma "lzma: A Python wrapper for the liblzma compression library."): module decompresses data incompletely. When decompressing a FORMAT_ALONE format file, and it doesn’t have the end marker, sometimes the last one to dozens bytes can’t be output. Patch by Ma Lin.
  * [bpo-35922](https://bugs.python.org/issue?@action=redirect&bpo=35922): Fix `RobotFileParser.crawl_delay()` and `RobotFileParser.request_rate()` to return `None` rather than raise [`AttributeError`](https://docs.python.org/3/library/exceptions.html#AttributeError "AttributeError") when no relevant rule is defined in the robots.txt file. Patch by Rémi Lapeyre.
  * [bpo-35766](https://bugs.python.org/issue?@action=redirect&bpo=35766): Change the format of feature_version to be a (major, minor) tuple.
  * [bpo-36607](https://bugs.python.org/issue?@action=redirect&bpo=36607): Eliminate [`RuntimeError`](https://docs.python.org/3/library/exceptions.html#RuntimeError "RuntimeError") raised by [`asyncio.all_tasks()`](https://docs.python.org/3/library/asyncio-task.html#asyncio.all_tasks "asyncio.all_tasks") if internal tasks weak set is changed by another thread during iteration.
  * [bpo-18748](https://bugs.python.org/issue?@action=redirect&bpo=18748): `_pyio.IOBase` destructor now does nothing if getting the `closed` attribute fails to better mimic `_io.IOBase` finalizer.
  * [bpo-36402](https://bugs.python.org/issue?@action=redirect&bpo=36402): Fix a race condition at Python shutdown when waiting for threads. Wait until the Python thread state of all non-daemon threads get deleted (join all non-daemon threads), rather than just wait until non-daemon Python threads complete.
  * [bpo-37206](https://bugs.python.org/issue?@action=redirect&bpo=37206): Default values which cannot be represented as Python objects no longer improperly represented as `None` in function signatures.
  * [bpo-37111](https://bugs.python.org/issue?@action=redirect&bpo=37111): Added `encoding` and `errors` keyword parameters to `logging.basicConfig`.
  * [bpo-12144](https://bugs.python.org/issue?@action=redirect&bpo=12144): Ensure cookies with `expires` attribute are handled in `CookieJar.make_cookies()`.
  * [bpo-34886](https://bugs.python.org/issue?@action=redirect&bpo=34886): Fix an unintended ValueError from [`subprocess.run()`](https://docs.python.org/3/library/subprocess.html#subprocess.run "subprocess.run") when checking for conflicting _input_ and _stdin_ or _capture_output_ and _stdout_ or _stderr_ args when they were explicitly provided but with `None` values within a passed in `**kwargs` dict rather than as passed directly by name. Patch contributed by Rémi Lapeyre.
  * [bpo-37173](https://bugs.python.org/issue?@action=redirect&bpo=37173): The exception message for `inspect.getfile()` now correctly reports the passed class rather than the builtins module.
  * [bpo-37178](https://bugs.python.org/issue?@action=redirect&bpo=37178): Give math.perm() a one argument form that means the same as math.factorial().
  * [bpo-37178](https://bugs.python.org/issue?@action=redirect&bpo=37178): For math.perm(n, k), let k default to n, giving the same result as factorial.
  * [bpo-37165](https://bugs.python.org/issue?@action=redirect&bpo=37165): Converted _collections._count_elements to use the Argument Clinic.
  * [bpo-34767](https://bugs.python.org/issue?@action=redirect&bpo=34767): Do not always create a [`collections.deque`](https://docs.python.org/3/library/collections.html#collections.deque "collections.deque") in [`asyncio.Lock`](https://docs.python.org/3/library/asyncio-sync.html#asyncio.Lock "asyncio.Lock").
  * [bpo-37158](https://bugs.python.org/issue?@action=redirect&bpo=37158): Speed-up statistics.fmean() by switching from a function to a generator.
  * [bpo-34282](https://bugs.python.org/issue?@action=redirect&bpo=34282): Remove `Enum._convert` method, deprecated in 3.8.
  * [bpo-37150](https://bugs.python.org/issue?@action=redirect&bpo=37150): `argparse._ActionsContainer.add_argument` now throws error, if someone accidentally pass FileType class object instead of instance of FileType as `type` argument.
  * [bpo-28724](https://bugs.python.org/issue?@action=redirect&bpo=28724): The socket module now has the [`socket.send_fds()`](https://docs.python.org/3/library/socket.html#socket.send_fds "socket.send_fds") and `socket.recv.fds()` methods.