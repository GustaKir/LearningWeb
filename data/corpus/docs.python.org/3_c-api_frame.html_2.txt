Title: PyFrame_GetLocals - Retrieve Frame Locals
URL: https://docs.python.org/3/c-api/frame.html
Summary: The function `PyFrame_GetLocals` retrieves the `f_locals` attribute of a given frame. It returns a write-through proxy for optimized scopes, allowing modifications, while in other contexts, it returns a direct mapping of frame locals as described by the `locals()` function.
---

[PyObject](https://docs.python.org/3/c-api/structures.html#c.PyObject "PyObject")*PyFrame_GetLocals([PyFrameObject](https://docs.python.org/3/c-api/frame.html#c.PyFrameObject "PyFrameObject")*frame)[¶](https://docs.python.org/3/c-api/frame.html#c.PyFrame_GetLocals "Link to this definition")
    _Return value: New reference._
Get the _frame_ ’s [`f_locals`](https://docs.python.org/3/reference/datamodel.html#frame.f_locals "frame.f_locals") attribute. If the frame refers to an [optimized scope](https://docs.python.org/3/glossary.html#term-optimized-scope), this returns a write-through proxy object that allows modifying the locals. In all other cases (classes, modules, [`exec()`](https://docs.python.org/3/library/functions.html#exec "exec"), [`eval()`](https://docs.python.org/3/library/functions.html#eval "eval")) it returns the mapping representing the frame locals directly (as described for [`locals()`](https://docs.python.org/3/library/functions.html#locals "locals")).
Return a [strong reference](https://docs.python.org/3/glossary.html#term-strong-reference).
Added in version 3.11.
Changed in version 3.13: As part of [**PEP 667**](https://peps.python.org/pep-0667/), return an instance of [`PyFrameLocalsProxy_Type`](https://docs.python.org/3/c-api/frame.html#c.PyFrameLocalsProxy_Type "PyFrameLocalsProxy_Type"). 

intPyFrame_GetLineNumber([PyFrameObject](https://docs.python.org/3/c-api/frame.html#c.PyFrameObject "PyFrameObject")*frame)[¶](https://docs.python.org/3/c-api/frame.html#c.PyFrame_GetLineNumber "Link to this definition")
    _Part of the[ Stable ABI](https://docs.python.org/3/c-api/stable.html#stable) since version 3.10._
Return the line number that _frame_ is currently executing.
## Frame Locals Proxies[¶](https://docs.python.org/3/c-api/frame.html#frame-locals-proxies "Link to this heading")
Added in version 3.13.
The [`f_locals`](https://docs.python.org/3/reference/datamodel.html#frame.f_locals "frame.f_locals") attribute on a [frame object](https://docs.python.org/3/reference/datamodel.html#frame-objects) is an instance of a “frame-locals proxy”. The proxy object exposes a write-through view of the underlying locals dictionary for the frame. This ensures that the variables exposed by `f_locals` are always up to date with the live local variables in the frame itself.
See [**PEP 667**](https://peps.python.org/pep-0667/) for more information. 

[PyTypeObject](https://docs.python.org/3/c-api/type.html#c.PyTypeObject "PyTypeObject")PyFrameLocalsProxy_Type[¶](https://docs.python.org/3/c-api/frame.html#c.PyFrameLocalsProxy_Type "Link to this definition")
    
The type of frame [`locals()`](https://docs.python.org/3/library/functions.html#locals "locals") proxy objects. 

intPyFrameLocalsProxy_Check([PyObject](https://docs.python.org/3/c-api/structures.html#c.PyObject "PyObject")*obj)[¶](https://docs.python.org/3/c-api/frame.html#c.PyFrameLocalsProxy_Check "Link to this definition")
    
Return non-zero if _obj_ is a frame [`locals()`](https://docs.python.org/3/library/functions.html#locals "locals") proxy.
## Internal Frames[¶](https://docs.python.org/3/c-api/frame.html#internal-frames "Link to this heading")
Unless using [**PEP 523**](https://peps.python.org/pep-0523/), you will not need this. 

struct_PyInterpreterFrame[¶](https://docs.python.org/3/c-api/frame.html#c._PyInterpreterFrame "Link to this definition")
    
The interpreter’s internal frame representation.
Added in version 3.11. 

[PyObject](https://docs.python.org/3/c-api/structures.html#c.PyObject "PyObject")*PyUnstable_InterpreterFrame_GetCode(struct[_PyInterpreterFrame](https://docs.python.org/3/c-api/frame.html#c._PyInterpreterFrame "_PyInterpreterFrame")*frame);[¶](https://docs.python.org/3/c-api/frame.html#c.PyUnstable_InterpreterFrame_GetCode "Link to this definition")
    
_This is[ Unstable API](https://docs.python.org/3/c-api/stable.html#unstable-c-api). It may change without warning in minor releases._
> Return a [strong reference](https://docs.python.org/3/glossary.html#term-strong-reference) to the code object for the frame.
Added in version 3.12. 

intPyUnstable_InterpreterFrame_GetLasti(struct[_PyInterpreterFrame](https://docs.python.org/3/c-api/frame.html#c._PyInterpreterFrame "_PyInterpreterFrame")*frame);[¶](https://docs.python.org/3/c-api/frame.html#c.PyUnstable_InterpreterFrame_GetLasti "Link to this definition")
    
_This is[ Unstable API](https://docs.python.org/3/c-api/stable.html#unstable-c-api). It may change without warning in minor releases._
Return the byte offset into the last executed instruction.
Added in version 3.12.