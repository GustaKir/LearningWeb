Title: Python 3 Changelog Highlights
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: Key updates in Python 3 include: `sys.stderr` is now line-buffered by default when redirected to a file, with options for unbuffered output; crashes in list methods have been addressed with stronger references; and .br encoding has been added to mimetypes encodings_map.
---

o-13601](https://bugs.python.org/issue?@action=redirect&bpo=13601): By default, `sys.stderr` is line-buffered now, even if `stderr` is redirected to a file. You can still make `sys.stderr` unbuffered by passing the [`-u`](https://docs.python.org/3/using/cmdline.html#cmdoption-u) command-line option or setting the [`PYTHONUNBUFFERED`](https://docs.python.org/3/using/cmdline.html#envvar-PYTHONUNBUFFERED) environment variable.
(Contributed by Jendrik Seipp in [bpo-13601](https://bugs.python.org/issue?@action=redirect&bpo=13601).)
  * [bpo-38610](https://bugs.python.org/issue?@action=redirect&bpo=38610): Fix possible crashes in several list methods by holding strong references to list elements when calling [`PyObject_RichCompareBool()`](https://docs.python.org/3/c-api/object.html#c.PyObject_RichCompareBool "PyObject_RichCompareBool").
  * [bpo-32021](https://bugs.python.org/issue?@action=redirect&bpo=32021): Include brotli .br encoding in mimetypes encodings_map


### Library[¶](https://docs.python.org/3/whatsnew/changelog.html#id409 "Link to this heading")
  * [bpo-39430](https://bugs.python.org/issue?@action=redirect&bpo=39430): Fixed race condition in lazy imports in [`tarfile`](https://docs.python.org/3/library/tarfile.html#module-tarfile "tarfile: Read and write tar-format archive files.").
  * [bpo-39413](https://bugs.python.org/issue?@action=redirect&bpo=39413): The [`os.unsetenv()`](https://docs.python.org/3/library/os.html#os.unsetenv "os.unsetenv") function is now also available on Windows.
  * [bpo-39390](https://bugs.python.org/issue?@action=redirect&bpo=39390): Fixed a regression with the `ignore` callback of [`shutil.copytree()`](https://docs.python.org/3/library/shutil.html#shutil.copytree "shutil.copytree"). The argument types are now `str` and `List[str]` again.
  * [bpo-39395](https://bugs.python.org/issue?@action=redirect&bpo=39395): The [`os.putenv()`](https://docs.python.org/3/library/os.html#os.putenv "os.putenv") and [`os.unsetenv()`](https://docs.python.org/3/library/os.html#os.unsetenv "os.unsetenv") functions are now always available.
  * [bpo-39406](https://bugs.python.org/issue?@action=redirect&bpo=39406): If `setenv()` C function is available, [`os.putenv()`](https://docs.python.org/3/library/os.html#os.putenv "os.putenv") is now implemented with `setenv()` instead of `putenv()`, so Python doesn’t have to handle the environment variable memory.
  * [bpo-39396](https://bugs.python.org/issue?@action=redirect&bpo=39396): Fix `math.nextafter(-0.0, +0.0)` on AIX 7.1.
  * [bpo-29435](https://bugs.python.org/issue?@action=redirect&bpo=29435): Allow [`tarfile.is_tarfile()`](https://docs.python.org/3/library/tarfile.html#tarfile.is_tarfile "tarfile.is_tarfile") to be used with file and file-like objects, like [`zipfile.is_zipfile()`](https://docs.python.org/3/library/zipfile.html#zipfile.is_zipfile "zipfile.is_zipfile"). Patch by William Woodruff.
  * [bpo-39377](https://bugs.python.org/issue?@action=redirect&bpo=39377): Removed `encoding` option from [`json.loads()`](https://docs.python.org/3/library/json.html#json.loads "json.loads"). It has been deprecated since Python 3.1.
  * [bpo-39389](https://bugs.python.org/issue?@action=redirect&bpo=39389): Write accurate compression level metadata in [`gzip`](https://docs.python.org/3/library/gzip.html#module-gzip "gzip: Interfaces for gzip compression and decompression using file objects.") archives, rather than always signaling maximum compression.
  * [bpo-39366](https://bugs.python.org/issue?@action=redirect&bpo=39366): The previously deprecated `xpath()` and `xgtitle()` methods of `nntplib.NNTP` have been removed.
  * [bpo-39357](https://bugs.python.org/issue?@action=redirect&bpo=39357): Remove the _buffering_ parameter of [`bz2.BZ2File`](https://docs.python.org/3/library/bz2.html#bz2.BZ2File "bz2.BZ2File"). Since Python 3.0, it was ignored and using it was emitting [`DeprecationWarning`](https://docs.python.org/3/library/exceptions.html#DeprecationWarning "DeprecationWarning"). Pass an open file object, to control how the file is opened. The _compresslevel_ parameter becomes keyword-only.
  * [bpo-39353](https://bugs.python.org/issue?@action=redirect&bpo=39353): Deprecate binhex4 and hexbin4 standards. Deprecate the `binhex` module and the following [`binascii`](https://docs.python.org/3/library/binascii.html#module-binascii "binascii: Tools for converting between binary and various ASCII-encoded binary representations.") functions: `b2a_hqx()`, `a2b_hqx()`, `rlecode_hqx()`, `rledecode_hqx()`, [`crc_hqx()`](https://docs.python.org/3/library/binascii.html#binascii.crc_hqx "binascii.crc_hqx").
  * [bpo-39351](https://bugs.python.org/issue?@action=redirect&bpo=39351): Remove `base64.encodestring()` and `base64.decodestring()`, aliases deprecated since Python 3.1: use [`base64.encodebytes()`](https://docs.python.org/3/library/base64.html#base64.encodebytes "base64.encodebytes") and [`base64.decodebytes()`](https://docs.python.org/3/library/base6