Title: Python Build Fixes and Enhancements
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This document section details several bug fixes and enhancements for building Python, particularly on Cygwin and with locale support. Key fixes include adjustments for the _struct module, extension modules, and system libffi detection, involving contributions from various patch authors.
---

o=21124): Fix building the _struct module on Cygwin by passing `NULL` instead of `&PyType_Type` to PyVarObject_HEAD_INIT. Patch by Masayuki Yamamoto.
  * [bpo-13756](https://bugs.python.org/issue?@action=redirect&bpo=13756): Fix building extensions modules on Cygwin. Patch by Roumen Petrov, based on original patch by Jason Tishler.
  * [bpo-21085](https://bugs.python.org/issue?@action=redirect&bpo=21085): Add configure check for siginfo_t.si_band, which Cygwin does not provide. Patch by Masayuki Yamamoto with review and rebase by Erik Bray.
  * [bpo-28258](https://bugs.python.org/issue?@action=redirect&bpo=28258): Fixed build with Estonian locale (python-config and distclean targets in Makefile). Patch by Arfrever Frehtes Taifersar Arahesis.
  * [bpo-26661](https://bugs.python.org/issue?@action=redirect&bpo=26661): setup.py now detects system libffi with multiarch wrapper.
  * [bpo-27979](https://bugs.python.org/issue?@action=redirect&bpo=27979): A full copy of libffi is no longer bundled for use when building _ctypes on non-OSX UNIX platforms. An installed copy of libffi is now required when building _ctypes on such platforms.
  * [bpo-15819](https://bugs.python.org/issue?@action=redirect&bpo=15819): Remove redundant include search directory option for building outside the source tree.
  * [bpo-28676](https://bugs.python.org/issue?@action=redirect&bpo=28676): Prevent missing ‘getentropy’ declaration warning on macOS. Patch by Gareth Rees.


### Windows[¶](https://docs.python.org/3/whatsnew/changelog.html#id566 "Link to this heading")
  * [bpo-31392](https://bugs.python.org/issue?@action=redirect&bpo=31392): Update Windows build to use OpenSSL 1.1.0f
  * [bpo-30389](https://bugs.python.org/issue?@action=redirect&bpo=30389): Adds detection of Visual Studio 2017 to distutils on Windows.
  * [bpo-31358](https://bugs.python.org/issue?@action=redirect&bpo=31358): zlib is no longer bundled in the CPython source, instead it is downloaded on demand just like bz2, lzma, OpenSSL, Tcl/Tk, and SQLite.
  * [bpo-31340](https://bugs.python.org/issue?@action=redirect&bpo=31340): Change to building with MSVC v141 (included with Visual Studio 2017)
  * [bpo-30581](https://bugs.python.org/issue?@action=redirect&bpo=30581): os.cpu_count() now returns the correct number of processors on Windows when the number of logical processors is greater than 64.
  * [bpo-30916](https://bugs.python.org/issue?@action=redirect&bpo=30916): Pre-build OpenSSL, Tcl and Tk and include the binaries in the build.
  * [bpo-30731](https://bugs.python.org/issue?@action=redirect&bpo=30731): Add a missing xmlns to python.manifest so that it matches the schema.
  * [bpo-30291](https://bugs.python.org/issue?@action=redirect&bpo=30291): Allow requiring 64-bit interpreters from py.exe using -64 suffix. Contributed by Steve (Gadget) Barnes.
  * [bpo-30362](https://bugs.python.org/issue?@action=redirect&bpo=30362): Adds list options (-0, -0p) to py.exe launcher. Contributed by Steve Barnes.
  * [bpo-23451](https://bugs.python.org/issue?@action=redirect&bpo=23451): Fix socket deprecation warnings in socketmodule.c. Patch by Segev Finer.
  * [bpo-30450](https://bugs.python.org/issue?@action=redirect&bpo=30450): The build process on Windows no longer depends on Subversion, instead pulling external code from GitHub via a Python script. If Python 3.6 is not found on the system (via `py -3.6`), NuGet is used to download a copy of 32-bit Python.
  * [bpo-29579](https://bugs.python.org/issue?@action=redirect&bpo=29579): Removes readme.txt from the installer.
  * [bpo-25778](https://bugs.python.org/issue?@action=redirect&bpo=25778): winreg does not truncate string correctly (Patch by Eryk Sun)
  * [bpo-28896](https://bugs.python.org/issue?@action=redirect&bpo=28896): Deprecate WindowsRegistryFinder and disable it by default
  * [bpo-28522](https://bugs.python.org/issue?@action=redirect&bpo=28522): Fixes mishandled buffer reallocation in getpathp.c
  * [bpo-28402](https://bugs.python.org/issue?@action=redirect&bpo=28402): Adds signed catalog files for stdlib on Windows.
  * [bpo-28333](https://bugs.python.org/issue?@action=redirect&bpo=28333): Enables Unicode for ps1/ps2 and input() prompts. (Patch by Eryk Sun)
  * [bpo-28251](https://bugs.python.org/issue?@action=redirect&bpo=28251): Improvements to help manuals on Windows.
  * [bpo-28110](https://bugs.python.org/issue?@action=redirect&bpo=28110): launcher.msi has different product codes between 32-bit and 64-bit
  * [bpo-28161](https://bugs.python.org/issue?@action=redirect&bpo=28161): Opening CON for write access fails
  * [bpo-28162](https://bugs.python.org/issue?@action=redirect&bpo=28162): WindowsConsoleIO readall() fails if first line starts with Ctrl+Z
  * [bpo-28163](https://bugs.python.org/issue?@action=redirect&bpo=28163): WindowsConsoleIO fileno() passes wrong flags to _open_osfhandle
  * [bpo-28164](https://bugs.python.org/issue?@action=redirect&bpo=28164): _PyIO_get_console_type fails for various paths