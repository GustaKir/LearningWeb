Title: Python 3 Updates on 'zlib' and Other Modules
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This chunk outlines several enhancements and fixes in Python 3, including improved handling of large buffers in the 'zlib' module, implementation of PEP 495 for local time disambiguation, and exposure of various constants in the 'select' module. It also addresses issues related to overflow in the 'audioop' module and enhancements in the handling of the Global Interpreter Lock (GIL).
---

n the “zlib” module, fix handling of large buffers (typically 4 GiB) when compressing and decompressing. Previously, inputs were limited to 4 GiB, and compression and decompression operations did not properly handle results of 4 GiB.
  * [bpo-24773](https://bugs.python.org/issue?@action=redirect&bpo=24773): Implemented [**PEP 495**](https://peps.python.org/pep-0495/) (Local Time Disambiguation).
  * Expose the EPOLLEXCLUSIVE constant (when it is defined) in the select module.
  * [bpo-27567](https://bugs.python.org/issue?@action=redirect&bpo=27567): Expose the EPOLLRDHUP and POLLRDHUP constants in the select module.
  * [bpo-1621](https://bugs.python.org/issue?@action=redirect&bpo=1621): Avoid signed int negation overflow in the “audioop” module.
  * [bpo-27533](https://bugs.python.org/issue?@action=redirect&bpo=27533): Release GIL in nt._isdir
  * [bpo-17711](https://bugs.python.org/issue?@action=redirect&bpo=17711): Fixed unpickling by the persistent ID with protocol 0. Original patch by Alexandre Vassalotti.
  * [bpo-27522](https://bugs.python.org/issue?@action=redirect&bpo=27522): Avoid an unintentional reference cycle in email.feedparser.
  * [bpo-27512](https://bugs.python.org/issue?@action=redirect&bpo=27512): Fix a segfault when os.fspath() called an __fspath__() method that raised an exception. Patch by Xiang Zhang.


### IDLE[¶](https://docs.python.org/3/whatsnew/changelog.html#id670 "Link to this heading")
  * [bpo-27714](https://bugs.python.org/issue?@action=redirect&bpo=27714): text_textview and test_autocomplete now pass when re-run in the same process. This occurs when test_idle fails when run with the -w option but without -jn. Fix warning from test_config.
  * [bpo-27621](https://bugs.python.org/issue?@action=redirect&bpo=27621): Put query response validation error messages in the query box itself instead of in a separate messagebox. Redo tests to match. Add Mac OSX refinements. Original patch by Mark Roseman.
  * [bpo-27620](https://bugs.python.org/issue?@action=redirect&bpo=27620): Escape key now closes Query box as cancelled.
  * [bpo-27609](https://bugs.python.org/issue?@action=redirect&bpo=27609): IDLE: tab after initial whitespace should tab, not autocomplete. This fixes problem with writing docstrings at least twice indented.
  * [bpo-27609](https://bugs.python.org/issue?@action=redirect&bpo=27609): Explicitly return None when there are also non-None returns. In a few cases, reverse a condition and eliminate a return.
  * [bpo-25507](https://bugs.python.org/issue?@action=redirect&bpo=25507): IDLE no longer runs buggy code because of its tkinter imports. Users must include the same imports required to run directly in Python.
  * [bpo-27173](https://bugs.python.org/issue?@action=redirect&bpo=27173): Add ‘IDLE Modern Unix’ to the built-in key sets. Make the default key set depend on the platform. Add tests for the changes to the config module.
  * [bpo-27452](https://bugs.python.org/issue?@action=redirect&bpo=27452): add line counter and crc to IDLE configHandler test dump.


### Tests[¶](https://docs.python.org/3/whatsnew/changelog.html#id671 "Link to this heading")
  * [bpo-25805](https://bugs.python.org/issue?@action=redirect&bpo=25805): Skip a test in test_pkgutil as needed that doesn’t work when `__name__ == __main__`. Patch by SilentGhost.
  * [bpo-27472](https://bugs.python.org/issue?@action=redirect&bpo=27472): Add test.support.unix_shell as the path to the default shell.
  * [bpo-27369](https://bugs.python.org/issue?@action=redirect&bpo=27369): In test_pyexpat, avoid testing an error message detail that changed in Expat 2.2.0.
  * [bpo-27594](https://bugs.python.org/issue?@action=redirect&bpo=27594): Prevent assertion error when running test_ast with coverage enabled: ensure code object has a valid first line number. Patch suggested by Ivan Levkivskyi.


### Windows[¶](https://docs.python.org/3/whatsnew/changelog.html#id672 "Link to this heading")
  * [bpo-27647](https://bugs.python.org/issue?@action=redirect&bpo=27647): Update bundled Tcl/Tk to 8.6.6.
  * [bpo-27610](https://bugs.python.org/issue?@action=redirect&bpo=27610): Adds [**PEP 514**](https://peps.python.org/pep-0514/) metadata to Windows installer
  * [bpo-27469](https://bugs.python.org/issue?@action=redirect&bpo=27469): Adds a shell extension to the launcher so that drag and drop works correctly.
  * [bpo-27309](https://bugs.python.org/issue?@action=redirect&bpo=27309): Enables proper Windows styles in python[w].exe manifest.