Title: winreg Module Functions: QueryInfoKey and QueryValue
URL: https://docs.python.org/3/library/winreg.html
Summary: The winreg module provides functions to interact with the Windows registry. QueryInfoKey returns a tuple with details about a registry key, including the number of subkeys, the number of values, and the last modification time. QueryValue retrieves the unnamed value for a specified key as a string.
---

winreg.QueryInfoKey(_key_)[¶](https://docs.python.org/3/library/winreg.html#winreg.QueryInfoKey "Link to this definition")
    
Returns information about a key, as a tuple.
_key_ is an already open key, or one of the predefined [HKEY_* constants](https://docs.python.org/3/library/winreg.html#hkey-constants).
The result is a tuple of 3 items:
Index | Meaning  
---|---  
`0` | An integer giving the number of sub keys this key has.  
`1` | An integer giving the number of values this key has.  
`2` | An integer giving when the key was last modified (if available) as 100’s of nanoseconds since Jan 1, 1601.  
Raises an [auditing event](https://docs.python.org/3/library/sys.html#auditing) `winreg.QueryInfoKey` with argument `key`. 

winreg.QueryValue(_key_ , _sub_key_)[¶](https://docs.python.org/3/library/winreg.html#winreg.QueryValue "Link to this definition")
    
Retrieves the unnamed value for a key, as a string.
_key_ is an already open key, or one of the predefined [HKEY_* constants](https://docs.python.org/3/library/winreg.html#hkey-constants).
_sub_key_ is a string that holds the name of the subkey with which the value is associated. If this parameter is `None` or empty, the function retrieves the value set by the [`SetValue()`](https://docs.python.org/3/library/winreg.html#winreg.SetValue "winreg.SetValue") method for the key identified by _key_.
Values in the registry have name, type, and data components. This method retrieves the data for a key’s first value that has a `NULL` name. But the underlying API call doesn’t return the type, so always use [`QueryValueEx()`](https://docs.python.org/3/library/winreg.html#winreg.QueryValueEx "winreg.QueryValueEx") if possible.
Raises an [auditing event](https://docs.python.org/3/library/sys.html#auditing) `winreg.QueryValue` with arguments `key`, `sub_key`, `value_name`. 

winreg.QueryValueEx(_key_ , _value_name_)[¶](https://docs.python.org/3/library/winreg.html#winreg.QueryValueEx "Link to this definition")
    
Retrieves the type and data for a specified value name associated with an open registry key.
_key_ is an already open key, or one of the predefined [HKEY_* constants](https://docs.python.org/3/library/winreg.html#hkey-constants).
_value_name_ is a string indicating the value to query.
The result is a tuple of 2 items:
Index | Meaning  
---|---  
`0` | The value of the registry item.  
`1` | An integer giving the registry type for this value (see table in docs for [`SetValueEx()`](https://docs.python.org/3/library/winreg.html#winreg.SetValueEx "winreg.SetValueEx"))  
Raises an [auditing event](https://docs.python.org/3/library/sys.html#auditing) `winreg.QueryValue` with arguments `key`, `sub_key`, `value_name`. 

winreg.SaveKey(_key_ , _file_name_)[¶](https://docs.python.org/3/library/winreg.html#winreg.SaveKey "Link to this definition")
    
Saves the specified key, and all its subkeys to the specified file.
_key_ is an already open key, or one of the predefined [HKEY_* constants](https://docs.python.org/3/library/winreg.html#hkey-constants).
_file_name_ is the name of the file to save registry data to. This file cannot already exist. If this filename includes an extension, it cannot be used on file allocation table (FAT) file systems by the [`LoadKey()`](https://docs.python.org/3/library/winreg.html#winreg.LoadKey "winreg.LoadKey") method.
If _key_ represents a key on a remote computer, the path described by _file_name_ is relative to the remote computer. The caller of this method must possess the **SeBackupPrivilege** security privilege. Note that privileges are different than permissions – see the [Conflicts Between User Rights and Permissions documentation](https://msdn.microsoft.com/en-us/library/ms724878%28v=VS.85%29.aspx) for more details.
This function passes `NULL` for _security_attributes_ to the API.
Raises an [auditing event](https://docs.python.org/3/library/sys.html#auditing) `winreg.SaveKey` with arguments `key`, `file_name`.