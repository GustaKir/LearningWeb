Title: Python 3.7.0 Beta 4 Release Notes
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This document outlines updates and bug fixes in IDLE and core builtins for Python 3.7.0 beta 4, including code cleanup, improved async block recognition, and new syntax error raises for async statements.
---

### IDLE[¶](https://docs.python.org/3/whatsnew/changelog.html#id498 "Link to this heading")
  * [bpo-33628](https://bugs.python.org/issue?@action=redirect&bpo=33628): IDLE: Cleanup codecontext.py and its test.
  * [bpo-33564](https://bugs.python.org/issue?@action=redirect&bpo=33564): IDLE’s code context now recognizes async as a block opener.
  * [bpo-32831](https://bugs.python.org/issue?@action=redirect&bpo=32831): Add docstrings and tests for codecontext.


## Python 3.7.0 beta 4[¶](https://docs.python.org/3/whatsnew/changelog.html#python-3-7-0-beta-4 "Link to this heading")
_Release date: 2018-05-02_
### Core and Builtins[¶](https://docs.python.org/3/whatsnew/changelog.html#id499 "Link to this heading")
  * [bpo-33363](https://bugs.python.org/issue?@action=redirect&bpo=33363): Raise a SyntaxError for `async with` and `async for` statements outside of async functions.
  * [bpo-33128](https://bugs.python.org/issue?@action=redirect&bpo=33128): Fix a bug that causes PathFinder to appear twice on sys.meta_path. Patch by Pablo Galindo Salgado.
  * [bpo-33312](https://bugs.python.org/issue?@action=redirect&bpo=33312): Fixed clang ubsan (undefined behavior sanitizer) warnings in dictobject.c by adjusting how the internal struct _dictkeysobject shared keys structure is declared.
  * [bpo-33231](https://bugs.python.org/issue?@action=redirect&bpo=33231): Fix potential memory leak in `normalizestring()`.
  * [bpo-33205](https://bugs.python.org/issue?@action=redirect&bpo=33205): Change dict growth function from `round_up_to_power_2(used*2+hashtable_size/2)` to `round_up_to_power_2(used*3)`. Previously, dict is shrinked only when `used == 0`. Now dict has more chance to be shrinked.
  * [bpo-29922](https://bugs.python.org/issue?@action=redirect&bpo=29922): Improved error messages in ‘async with’ when `__aenter__()` or `__aexit__()` return non-awaitable object.
  * [bpo-33199](https://bugs.python.org/issue?@action=redirect&bpo=33199): Fix `ma_version_tag` in dict implementation is uninitialized when copying from key-sharing dict.