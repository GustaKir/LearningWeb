Title: Test Updates in Python
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section details various updates to Python tests, including skipping specific tests on macOS and Linux due to compatibility issues, splitting runtime embedding tests into a separate file, and removing the requires_multiprocessing_queue decorator from tests.
---

### Tests[¶](https://docs.python.org/3/whatsnew/changelog.html#id547 "Link to this heading")
  * [bpo-31380](https://bugs.python.org/issue?@action=redirect&bpo=31380): Skip test_httpservers test_undecodable_file on macOS: fails on APFS.
  * [bpo-31705](https://bugs.python.org/issue?@action=redirect&bpo=31705): Skip test_socket.test_sha256() on Linux kernel older than 4.5. The test fails with ENOKEY on kernel 3.10 (on ppc64le). A fix was merged into the kernel 4.5.
  * [bpo-32138](https://bugs.python.org/issue?@action=redirect&bpo=32138): Skip on Android test_faulthandler tests that raise SIGSEGV and remove the test.support.requires_android_level decorator.
  * [bpo-32136](https://bugs.python.org/issue?@action=redirect&bpo=32136): The runtime embedding tests have been split out from `Lib/test/test_capi.py` into a new `Lib/test/test_embed.py` file.
  * [bpo-28668](https://bugs.python.org/issue?@action=redirect&bpo=28668): test.support.requires_multiprocessing_queue is removed. Skip tests with test.support.import_module(‘multiprocessing.synchronize’) instead when the semaphore implementation is broken or missing.
  * [bpo-32126](https://bugs.python.org/issue?@action=redirect&bpo=32126): Skip test_get_event_loop_new_process in test.test_asyncio.test_events when sem_open() is not functional.
  * [bpo-31174](https://bugs.python.org/issue?@action=redirect&bpo=31174): Fix test_tools.test_unparse: DirectoryTestCase now stores the names sample to always test the same files. It prevents false alarms when hunting reference leaks.


### Build[¶](https://docs.python.org/3/whatsnew/changelog.html#id548 "Link to this heading")
  * [bpo-28538](https://bugs.python.org/issue?@action=redirect&bpo=28538): Revert the previous changes, the if_nameindex structure is defined by Unified Headers.
  * [bpo-28762](https://bugs.python.org/issue?@action=redirect&bpo=28762): Revert the last commit, the F_LOCK macro is defined by Android Unified Headers.
  * [bpo-29040](https://bugs.python.org/issue?@action=redirect&bpo=29040): Support building Android with Unified Headers. The first NDK release to support Unified Headers is android-ndk-r14.
  * [bpo-32059](https://bugs.python.org/issue?@action=redirect&bpo=32059): `detect_modules()` in `setup.py` now also searches the sysroot paths when cross-compiling.
  * [bpo-31957](https://bugs.python.org/issue?@action=redirect&bpo=31957): Fixes Windows SDK version detection when building for Windows.
  * [bpo-31609](https://bugs.python.org/issue?@action=redirect&bpo=31609): Fixes quotes in PCbuild/clean.bat
  * [bpo-31934](https://bugs.python.org/issue?@action=redirect&bpo=31934): Abort the build when building out of a not clean source tree.
  * [bpo-31926](https://bugs.python.org/issue?@action=redirect&bpo=31926): Fixed Argument Clinic sometimes causing compilation errors when there was more than one function and/or method in a .c file with the same name.
  * [bpo-28791](https://bugs.python.org/issue?@action=redirect&bpo=28791): Update Windows builds to use SQLite 3.21.0.
  * [bpo-28791](https://bugs.python.org/issue?@action=redirect&bpo=28791): Update OS X installer to use SQLite 3.21.0.
  * [bpo-28643](https://bugs.python.org/issue?@action=redirect&bpo=28643): Record profile-opt build progress with stamp files.
  * [bpo-31866](https://bugs.python.org/issue?@action=redirect&bpo=31866): Finish removing support for AtheOS.


### Windows[¶](https://docs.python.org/3/whatsnew/changelog.html#id549 "Link to this heading")
  * [bpo-1102](https://bugs.python.org/issue?@action=redirect&bpo=1102): Return `None` when `View.Fetch()` returns `ERROR_NO_MORE_ITEMS` instead of raising `MSIError`. Initial patch by Anthony Tuininga.
  * [bpo-31944](https://bugs.python.org/issue?@action=redirect&bpo=31944): Fixes Modify button in Apps and Features dialog.
  * [bpo-20486](https://bugs.python.org/issue?@action=redirect&bpo=20486): Implement the `Database.Close()` method to help closing MSI database objects.
  * [bpo-31857](https://bugs.python.org/issue?@action=redirect&bpo=31857): Make the behavior of USE_STACKCHECK deterministic in a multi-threaded environment.


### macOS[¶](https://docs.python.org/3/whatsnew/changelog.html#id550 "Link to this heading")
  * [bpo-31392](https://bugs.python.org/issue?@action=redirect&bpo=31392): Update macOS installer to use OpenSSL 1.0.2m