Title: Python Release Notes Updates
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: The patch introduces several key improvements: acquiring strong references during set iterations to avoid crashes from mutations, optimizing the bytecode compiler for runtime stack manipulations, and addressing a portability issue in `PyLong_FromLong()` while enhancing `PyLong_FromLongLong()` for single-digit integers.
---

Patch by Donghee Na.
  * [bpo-46615](https://bugs.python.org/issue?@action=redirect&bpo=46615): When iterating over sets internally in `setobject.c`, acquire strong references to the resulting items from the set. This prevents crashes in corner-cases of various set operations where the set gets mutated.
  * [bpo-45828](https://bugs.python.org/issue?@action=redirect&bpo=45828): The bytecode compiler now attempts to apply runtime stack manipulations at compile-time (whenever it is feasible to do so).
  * [bpo-30496](https://bugs.python.org/issue?@action=redirect&bpo=30496): Fixed a minor portability issue in the implementation of [`PyLong_FromLong()`](https://docs.python.org/3/c-api/long.html#c.PyLong_FromLong "PyLong_FromLong"), and added a fast path for single-digit integers to [`PyLong_FromLongLong()`](https://docs.python.org/3/c-api/long.html#c.PyLong_FromLongLong "PyLong_FromLongLong").


### Library[Â¶](https://docs.python.org/3/whatsnew/changelog.html#id237 "Link to this heading")
  * [bpo-25707](https://bugs.python.org/issue?@action=redirect&bpo=25707): Fixed a file leak in [`xml.etree.ElementTree.iterparse()`](https://docs.python.org/3/library/xml.etree.elementtree.html#xml.etree.ElementTree.iterparse "xml.etree.ElementTree.iterparse") when the iterator is not exhausted. Patch by Jacob Walls.
  * [bpo-46877](https://bugs.python.org/issue?@action=redirect&bpo=46877): Export [`unittest.doModuleCleanups()`](https://docs.python.org/3/library/unittest.html#unittest.doModuleCleanups "unittest.doModuleCleanups") in [`unittest`](https://docs.python.org/3/library/unittest.html#module-unittest "unittest: Unit testing framework for Python."). Patch by Kumar Aditya.
  * [bpo-46848](https://bugs.python.org/issue?@action=redirect&bpo=46848): For performance, use the optimized string-searching implementations from [`find()`](https://docs.python.org/3/library/stdtypes.html#bytes.find "bytes.find") and [`rfind()`](https://docs.python.org/3/library/stdtypes.html#bytes.rfind "bytes.rfind") for `find()` and `rfind()`.
  * [bpo-46736](https://bugs.python.org/issue?@action=redirect&bpo=46736): [`SimpleHTTPRequestHandler`](https://docs.python.org/3/library/http.server.html#http.server.SimpleHTTPRequestHandler "http.server.SimpleHTTPRequestHandler") now uses HTML5 grammar. Patch by Donghee Na.
  * [bpo-44886](https://bugs.python.org/issue?@action=redirect&bpo=44886): Inherit asyncio proactor datagram transport from [`asyncio.DatagramTransport`](https://docs.python.org/3/library/asyncio-protocol.html#asyncio.DatagramTransport "asyncio.DatagramTransport").
  * [bpo-46827](https://bugs.python.org/issue?@action=redirect&bpo=46827): Support UDP sockets in [`asyncio.loop.sock_connect()`](https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.loop.sock_connect "asyncio.loop.sock_connect") for selector-based event loops. Patch by Thomas Grainger.
  * [bpo-46811](https://bugs.python.org/issue?@action=redirect&bpo=46811): Make test suite support Expat >=2.4.5
  * [bpo-46252](https://bugs.python.org/issue?@action=redirect&bpo=46252): Raise [`TypeError`](https://docs.python.org/3/library/exceptions.html#TypeError "TypeError") if [`ssl.SSLSocket`](https://docs.python.org/3/library/ssl.html#ssl.SSLSocket "ssl.SSLSocket") is passed to transport-based APIs.
  * [bpo-46784](https://bugs.python.org/issue?@action=redirect&bpo=46784): Fix libexpat symbols collisions with user dynamically loaded or statically linked libexpat in embedded Python.
  * [bpo-46786](https://bugs.python.org/issue?@action=redirect&bpo=46786): The HTML serialisation in xml.etree.ElementTree now writes `embed`, `source`, `track` and `wbr` as empty tags, as defined in HTML 5.
  * [bpo-39327](https://bugs.python.org/issue?@action=redirect&bpo=39327): [`shutil.rmtree()`](https://docs.python.org/3/library/shutil.html#shutil.rmtree "shutil.rmtree") can now work with VirtualBox shared folders when running from the guest operating-system.
  * [bpo-45390](https://bugs.python.org/issue?@action=redirect&bpo=45390): Propagate [`asyncio.CancelledError`](https://docs.python.org/3/library/asyncio-exceptions.html#asyncio.CancelledError "asyncio.CancelledError") message from inner task to outer awaiter.
  * [bpo-46756](https://bugs.python.org/issue?@action=redirect&bpo=46756): Fix a bug in [`urllib.request.HTTPPasswordMgr.find_user_password()`](https://docs.python.org/3/library/urllib.request.html#urllib.request.HTTPPasswordMgr.find_user_password "urllib.request.HTTPPasswordMgr.find_user_password") and [`urllib.request.HTTPPasswordMgrWithPriorAuth.is_authenticated()`](https://docs.python.org/3/library/urllib.request.html#urllib.request.HTTPPasswordMgrWithPriorAuth.is_authenticated "urllib.request.HTTPPasswordMgrWithPriorAuth.is_authenticated") which allowed to bypass authorization. For example, access to URI `example.org/foobar` was allowed if the user was authorized for URI `example.org/foo`.
  * [bpo-46737](https://bugs.python.org/issue?@action=redirect&bpo=46737): [`random.