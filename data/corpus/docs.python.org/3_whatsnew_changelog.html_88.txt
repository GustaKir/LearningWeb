Title: Library Changes in Python 3.15
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section details several library updates, including a fix for `repr()` with global `Flag` members, the deprecation of `platform.java_ver()`, a resolution of a race condition in pydoc's `_start_server`, and additional changes in the typing module.
---

### Library[¶](https://docs.python.org/3/whatsnew/changelog.html#id91 "Link to this heading")
  * [gh-116600](https://github.com/python/cpython/issues/116600): Fix [`repr()`](https://docs.python.org/3/library/functions.html#repr "repr") for global [`Flag`](https://docs.python.org/3/library/enum.html#enum.Flag "enum.Flag") members.
  * [gh-116349](https://github.com/python/cpython/issues/116349): [`platform.java_ver()`](https://docs.python.org/3/library/platform.html#platform.java_ver "platform.java_ver") is deprecated and will be removed in 3.15. It was largely untested, had a confusing API, and was only useful for Jython support.
  * [gh-116143](https://github.com/python/cpython/issues/116143): Fix a race in pydoc `_start_server`, eliminating a window in which `_start_server` can return a thread that is “serving” but without a `docserver` set.
  * [gh-116127](https://github.com/python/cpython/issues/116127): [`typing`](https://docs.python.org/3/library/typing.html#module-typing "typing: Support for type hints \(see :pep:`484`\)."): implement [**PEP 705**](https://peps.python.org/pep-0705/) which adds [`typing.ReadOnly`](https://docs.python.org/3/library/typing.html#typing.ReadOnly "typing.ReadOnly") support to [`typing.TypedDict`](https://docs.python.org/3/library/typing.html#typing.TypedDict "typing.TypedDict").
  * [gh-116325](https://github.com/python/cpython/issues/116325): [`typing`](https://docs.python.org/3/library/typing.html#module-typing "typing: Support for type hints \(see :pep:`484`\)."): raise [`SyntaxError`](https://docs.python.org/3/library/exceptions.html#SyntaxError "SyntaxError") instead of [`AttributeError`](https://docs.python.org/3/library/exceptions.html#AttributeError "AttributeError") on forward references as empty strings.
  * [gh-115957](https://github.com/python/cpython/issues/115957): When `asyncio.TaskGroup.create_task` is called on an inactive `asyncio.TaskGroup`, the given coroutine will be closed (which prevents a `RuntimeWarning`).
  * [gh-115978](https://github.com/python/cpython/issues/115978): Disable preadv(), readv(), pwritev(), and writev() on WASI.
Under wasmtime for WASI 0.2, these functions don’t pass test_posix (<https://github.com/bytecodealliance/wasmtime/issues/7830>).
  * [gh-88352](https://github.com/python/cpython/issues/88352): Fix the computation of the next rollover time in the `logging.TimedRotatingFileHandler` handler. `computeRollover()` now always returns a timestamp larger than the specified time and works correctly during the DST change. `doRollover()` no longer overwrite the already rolled over file, saving from data loss when run at midnight or during repeated time at the DST change.
  * [gh-87115](https://github.com/python/cpython/issues/87115): Set `__main__.__spec__` to `None` when running a script with [`pdb`](https://docs.python.org/3/library/pdb.html#module-pdb "pdb: The Python debugger for interactive interpreters.")
  * [gh-76511](https://github.com/python/cpython/issues/76511): Fix UnicodeEncodeError in `email.Message.as_string()` that results when a message that claims to be in the ascii character set actually has non-ascii characters. Non-ascii characters are now replaced with the U+FFFD replacement character, like in the `replace` error handler.
  * [gh-89547](https://github.com/python/cpython/issues/89547): Add support for nested typing special forms like Final[ClassVar[int]].
  * [gh-65824](https://github.com/python/cpython/issues/65824): Improve the `less` prompt in [`pydoc`](https://docs.python.org/3/library/pydoc.html#module-pydoc "pydoc: Documentation generator and online help system.").
  * [gh-116040](https://github.com/python/cpython/issues/116040): [Enum] fix by-value calls when second value is falsey; e.g. Cardinal(1, 0)
  * [gh-115821](https://github.com/python/cpython/issues/115821): [Enum] Improve error message when calling super().__new__() in custom __new__.
  * [gh-85644](https://github.com/python/cpython/issues/85644): Use the `XDG_CURRENT_DESKTOP` environment variable in [`webbrowser`](https://docs.python.org/3/library/webbrowser.html#module-webbrowser "webbrowser: Easy-to-use controller for web browsers.") to check desktop. Prefer it to the deprecated `GNOME_DESKTOP_SESSION_ID` for GNOME detection.
  * [gh-75988](https://github.com/python/cpython/issues/75988): Fixed [`unittest.mock.create_autospec()`](https://docs.python.org/3/library/unittest.mock.html#unittest.mock.create_autospec "unittest.mock.create_autospec") to pass the call through to the wrapped object to return the real result.
  * [gh-115881](https://github.com/python/cpython/issues/115881): Fix issue where [`ast.parse()`](https://docs.python.org/3/library/ast.html#ast.parse "ast.parse") would incorrectly flag conditional context managers (such as `with (x() if y else z()): ...`) as invalid syntax if `feature_version=(3, 8)` was passed. This reverts changes to the grammar made as part of [gh-94949](https://github.com/python/cpython/issues/94949).
  *