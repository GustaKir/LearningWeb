Title: Python 3.8 Changelog Updates
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This document details updates and bug fixes in Python 3.8, including improvements to importlib.metadata, adjustments to AsyncMock behavior, fixes in the signal module's reference counting, and the hiding of internal asyncio.Stream methods.
---

Patch by GÃ©ry Ogam.
  * [bpo-38086](https://bugs.python.org/issue?@action=redirect&bpo=38086): Update importlib.metadata with changes from [importlib_metadata 0.21](https://gitlab.com/python-devs/importlib_metadata/blob/0.21/importlib_metadata/docs/changelog.rst).
  * [bpo-37251](https://bugs.python.org/issue?@action=redirect&bpo=37251): Remove `__code__` check in AsyncMock that incorrectly evaluated function specs as async objects but failed to evaluate classes with `__await__` but no `__code__` attribute defined as async objects.
  * [bpo-38037](https://bugs.python.org/issue?@action=redirect&bpo=38037): Fix reference counters in the [`signal`](https://docs.python.org/3/library/signal.html#module-signal "signal: Set handlers for asynchronous events.") module.
  * [bpo-38066](https://bugs.python.org/issue?@action=redirect&bpo=38066): Hide internal asyncio.Stream methods: feed_eof(), feed_data(), set_exception() and set_transport().
  * [bpo-38059](https://bugs.python.org/issue?@action=redirect&bpo=38059): inspect.py now uses sys.exit() instead of exit()
  * [bpo-38049](https://bugs.python.org/issue?@action=redirect&bpo=38049): Added command-line interface for the [`ast`](https://docs.python.org/3/library/ast.html#module-ast "ast: Abstract Syntax Tree classes and manipulation.") module.
  * [bpo-37953](https://bugs.python.org/issue?@action=redirect&bpo=37953): In [`typing`](https://docs.python.org/3/library/typing.html#module-typing "typing: Support for type hints \(see :pep:`484`\)."), improved the `__hash__` and `__eq__` methods for `ForwardReferences`.
  * [bpo-38026](https://bugs.python.org/issue?@action=redirect&bpo=38026): Fixed [`inspect.getattr_static()`](https://docs.python.org/3/library/inspect.html#inspect.getattr_static "inspect.getattr_static") used `isinstance` while it should avoid dynamic lookup.
  * [bpo-35923](https://bugs.python.org/issue?@action=redirect&bpo=35923): Update [`importlib.machinery.BuiltinImporter`](https://docs.python.org/3/library/importlib.html#importlib.machinery.BuiltinImporter "importlib.machinery.BuiltinImporter") to use `loader._ORIGIN` instead of a hardcoded value. Patch by Donghee Na.
  * [bpo-38010](https://bugs.python.org/issue?@action=redirect&bpo=38010): In `importlib.metadata` sync with `importlib_metadata` 0.20, clarifying behavior of `files()` and fixing issue where only one requirement was returned for `requires()` on `dist-info` packages.
  * [bpo-38006](https://bugs.python.org/issue?@action=redirect&bpo=38006): weakref.WeakValueDictionary defines a local remove() function used as callback for weak references. This function was created with a closure. Modify the implementation to avoid the closure.
  * [bpo-37995](https://bugs.python.org/issue?@action=redirect&bpo=37995): Added the _indent_ option to [`ast.dump()`](https://docs.python.org/3/library/ast.html#ast.dump "ast.dump") which allows it to produce a multiline indented output.
  * [bpo-34410](https://bugs.python.org/issue?@action=redirect&bpo=34410): Fixed a crash in the `tee()` iterator when re-enter it. RuntimeError is now raised in this case.
  * [bpo-37140](https://bugs.python.org/issue?@action=redirect&bpo=37140): Fix a ctypes regression of Python 3.8. When a ctypes.Structure is passed by copy to a function, ctypes internals created a temporary object which had the side effect of calling the structure finalizer (__del__) twice. The Python semantics requires a finalizer to be called exactly once. Fix ctypes internals to no longer call the finalizer twice.
  * [bpo-37587](https://bugs.python.org/issue?@action=redirect&bpo=37587): `_json.scanstring` is now up to 3x faster when there are many backslash escaped characters in the JSON string.
  * [bpo-37834](https://bugs.python.org/issue?@action=redirect&bpo=37834): Prevent shutil.rmtree exception when built on non-Windows system without fd system call support, like older versions of macOS.
  * [bpo-10978](https://bugs.python.org/issue?@action=redirect&bpo=10978): Semaphores and BoundedSemaphores can now release more than one waiting thread at a time.
  * [bpo-37972](https://bugs.python.org/issue?@action=redirect&bpo=37972): Subscripts to the `unittest.mock.call` objects now receive the same chaining mechanism as any other custom attributes, so that the following usage no longer raises a `TypeError`:
`call().foo().__getitem__('bar')`
Patch by blhsing
  * [bpo-37965](https://bugs.python.org/issue?@action=redirect&bpo=37965): Fix C compiler warning caused by distutils.ccompiler.CCompiler.has_function.
  * [bpo-37964](https://bugs.python.org/issue?@action=redirect&bpo=37964): Add `F_GETPATH` command to [`fcntl`](https://docs.python.org/3/library/fcntl.html#module-fcntl "fcntl: The fcntl\(\) and ioctl\(\) system calls.