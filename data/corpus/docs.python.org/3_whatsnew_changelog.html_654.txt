Title: C API Changes in Python
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section details updates to the C API, including the replacement of the PySlice_GetIndicesEx() function with a macro under certain conditions, fixes to declarations of public API functions for compatibility with limited API, and the restriction of stable API extensions to specific PY_LIMITED_API settings.
---

### C API[¶](https://docs.python.org/3/whatsnew/changelog.html#id631 "Link to this heading")
  * [bpo-27867](https://bugs.python.org/issue?@action=redirect&bpo=27867): Function PySlice_GetIndicesEx() is replaced with a macro if Py_LIMITED_API is not set or set to the value between 0x03050400 and 0x03060000 (not including) or 0x03060100 or higher.
  * [bpo-29083](https://bugs.python.org/issue?@action=redirect&bpo=29083): Fixed the declaration of some public API functions. PyArg_VaParse() and PyArg_VaParseTupleAndKeywords() were not available in limited API. PyArg_ValidateKeywordArguments(), PyArg_UnpackTuple() and Py_BuildValue() were not available in limited API of version < 3.3 when PY_SSIZE_T_CLEAN is defined.
  * [bpo-29058](https://bugs.python.org/issue?@action=redirect&bpo=29058): All stable API extensions added after Python 3.2 are now available only when Py_LIMITED_API is set to the PY_VERSION_HEX value of the minimum Python version supporting this API.


### Documentation[¶](https://docs.python.org/3/whatsnew/changelog.html#id632 "Link to this heading")
  * [bpo-28929](https://bugs.python.org/issue?@action=redirect&bpo=28929): Link the documentation to its source file on GitHub.
  * [bpo-25008](https://bugs.python.org/issue?@action=redirect&bpo=25008): Document smtpd.py as effectively deprecated and add a pointer to aiosmtpd, a third-party asyncio-based replacement.
  * [bpo-26355](https://bugs.python.org/issue?@action=redirect&bpo=26355): Add canonical header link on each page to corresponding major version of the documentation. Patch by Matthias Bussonnier.
  * [bpo-29349](https://bugs.python.org/issue?@action=redirect&bpo=29349): Fix Python 2 syntax in code for building the documentation.


### Tests[¶](https://docs.python.org/3/whatsnew/changelog.html#id633 "Link to this heading")
  * [bpo-28087](https://bugs.python.org/issue?@action=redirect&bpo=28087): Skip test_asyncore and test_eintr poll failures on macOS. Skip some tests of select.poll when running on macOS due to unresolved issues with the underlying system poll function on some macOS versions.
  * [bpo-29571](https://bugs.python.org/issue?@action=redirect&bpo=29571): to match the behaviour of the `re.LOCALE` flag, test_re.test_locale_flag now uses `locale.getpreferredencoding(False)` to determine the candidate encoding for the test regex (allowing it to correctly skip the test when the default locale encoding is a multi-byte encoding)
  * [bpo-28950](https://bugs.python.org/issue?@action=redirect&bpo=28950): Disallow -j0 to be combined with -T/-l in regrtest command line arguments.
  * [bpo-28683](https://bugs.python.org/issue?@action=redirect&bpo=28683): Fix the tests that bind() a unix socket and raise PermissionError on Android for a non-root user.
  * [bpo-26939](https://bugs.python.org/issue?@action=redirect&bpo=26939): Add the support.setswitchinterval() function to fix test_functools hanging on the Android armv7 qemu emulator.


### Build[¶](https://docs.python.org/3/whatsnew/changelog.html#id634 "Link to this heading")
  * [bpo-27593](https://bugs.python.org/issue?@action=redirect&bpo=27593): sys.version and the platform module python_build(), python_branch(), and python_revision() functions now use git information rather than hg when building from a repo.
  * [bpo-29572](https://bugs.python.org/issue?@action=redirect&bpo=29572): Update Windows build and OS X installers to use OpenSSL 1.0.2k.
  * [bpo-26851](https://bugs.python.org/issue?@action=redirect&bpo=26851): Set Android compilation and link flags.
  * [bpo-28768](https://bugs.python.org/issue?@action=redirect&bpo=28768): Fix implicit declaration of function _setmode. Patch by Masayuki Yamamoto
  * [bpo-29080](https://bugs.python.org/issue?@action=redirect&bpo=29080): Removes hard dependency on hg.exe from PCBuild/build.bat
  * [bpo-23903](https://bugs.python.org/issue?@action=redirect&bpo=23903): Added missed names to PC/python3.def.
  * [bpo-28762](https://bugs.python.org/issue?@action=redirect&bpo=28762): lockf() is available on Android API level 24, but the F_LOCK macro is not defined in android-ndk-r13.
  * [bpo-28538](https://bugs.python.org/issue?@action=redirect&bpo=28538): Fix the compilation error that occurs because if_nameindex() is available on Android API level 24, but the if_nameindex structure is not defined.
  * [bpo-20211](https://bugs.python.org/issue?@action=redirect&bpo=20211): Do not add the directory for installing C header files and the directory for installing object code libraries to the cross compilation search paths. Original patch by Thomas Petazzoni.
  * [bpo-28849](https://bugs.python.org/issue?@action=redirect&bpo=28849): Do not define sys.implementation._multiarch on Android.