Title: Python 3 Update: Exception Handling and Library Changes
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This update includes behavior matching for `with` blocks when `__context__` is set to `None` during exceptions. Additionally, the cache size for compiled regex patterns in the `fnmatch` module has been increased from 256 to 32768, impacting several functions, and changes have been made to `shutil.copyfile()`.
---

They will now match `with` block behavior when `__context__` is explicitly set to `None` when the exception is in flight.
  * [bpo-42799](https://bugs.python.org/issue?@action=redirect&bpo=42799): In [`fnmatch`](https://docs.python.org/3/library/fnmatch.html#module-fnmatch "fnmatch: Unix shell style filename pattern matching."), the cache size for compiled regex patterns ([`functools.lru_cache()`](https://docs.python.org/3/library/functools.html#functools.lru_cache "functools.lru_cache")) was bumped up from 256 to 32768, affecting functions: [`fnmatch.fnmatch()`](https://docs.python.org/3/library/fnmatch.html#fnmatch.fnmatch "fnmatch.fnmatch"), [`fnmatch.fnmatchcase()`](https://docs.python.org/3/library/fnmatch.html#fnmatch.fnmatchcase "fnmatch.fnmatchcase"), [`fnmatch.filter()`](https://docs.python.org/3/library/fnmatch.html#fnmatch.filter "fnmatch.filter").
  * [bpo-41928](https://bugs.python.org/issue?@action=redirect&bpo=41928): Update [`shutil.copyfile()`](https://docs.python.org/3/library/shutil.html#shutil.copyfile "shutil.copyfile") to raise [`FileNotFoundError`](https://docs.python.org/3/library/exceptions.html#FileNotFoundError "FileNotFoundError") instead of confusing [`IsADirectoryError`](https://docs.python.org/3/library/exceptions.html#IsADirectoryError "IsADirectoryError") when a path ending with a `os.path.sep` does not exist; [`shutil.copy()`](https://docs.python.org/3/library/shutil.html#shutil.copy "shutil.copy") and [`shutil.copy2()`](https://docs.python.org/3/library/shutil.html#shutil.copy2 "shutil.copy2") are also affected.
  * [bpo-44569](https://bugs.python.org/issue?@action=redirect&bpo=44569): Added the `StackSummary.format_frame()` function in [`traceback`](https://docs.python.org/3/library/traceback.html#module-traceback "traceback: Print or retrieve a stack traceback."). This allows users to customize the way individual lines are formatted in tracebacks without re-implementing logic to handle recursive tracebacks.
  * [bpo-44566](https://bugs.python.org/issue?@action=redirect&bpo=44566): handle StopIteration subclass raised from @contextlib.contextmanager generator
  * [bpo-44558](https://bugs.python.org/issue?@action=redirect&bpo=44558): Make the implementation consistency of [`indexOf()`](https://docs.python.org/3/library/operator.html#operator.indexOf "operator.indexOf") between C and Python versions. Patch by Donghee Na.
  * [bpo-41249](https://bugs.python.org/issue?@action=redirect&bpo=41249): Fixes `TypedDict` to work with `typing.get_type_hints()` and postponed evaluation of annotations across modules.
  * [bpo-44554](https://bugs.python.org/issue?@action=redirect&bpo=44554): Refactor argument processing in `pdb.main()` to simplify detection of errors in input loading and clarify behavior around module or script invocation.
  * [bpo-34798](https://bugs.python.org/issue?@action=redirect&bpo=34798): Break up paragraph about [`pprint.PrettyPrinter`](https://docs.python.org/3/library/pprint.html#pprint.PrettyPrinter "pprint.PrettyPrinter") construction parameters to make it easier to read.
  * [bpo-44539](https://bugs.python.org/issue?@action=redirect&bpo=44539): Added support for recognizing JPEG files without JFIF or Exif markers.
  * [bpo-44461](https://bugs.python.org/issue?@action=redirect&bpo=44461): Fix bug with [`pdb`](https://docs.python.org/3/library/pdb.html#module-pdb "pdb: The Python debugger for interactive interpreters.")â€™s handling of import error due to a package which does not have a `__main__` module
  * [bpo-43625](https://bugs.python.org/issue?@action=redirect&bpo=43625): Fix a bug in the detection of CSV file headers by [`csv.Sniffer.has_header()`](https://docs.python.org/3/library/csv.html#csv.Sniffer.has_header "csv.Sniffer.has_header") and improve documentation of same.
  * [bpo-44516](https://bugs.python.org/issue?@action=redirect&bpo=44516): Update vendored pip to 21.1.3
  * [bpo-42892](https://bugs.python.org/issue?@action=redirect&bpo=42892): Fixed an exception thrown while parsing a malformed multipart email by [`email.message.EmailMessage`](https://docs.python.org/3/library/email.message.html#email.message.EmailMessage "email.message.EmailMessage").
  * [bpo-44468](https://bugs.python.org/issue?@action=redirect&bpo=44468): [`typing.get_type_hints()`](https://docs.python.org/3/library/typing.html#typing.get_type_hints "typing.get_type_hints") now finds annotations in classes and base classes with unexpected `__module__`. Previously, it skipped those MRO elements.
  * [bpo-44491](https://bugs.python.org/issue?@action=redirect&bpo=44491): Allow clearing the [`sqlite3`](https://docs.python.org/3/library/sqlite3.html#module-sqlite3 "sqlite3: A DB-API 2.0 implementation using SQLite 3.x.") authorizer callback by passing [`None`](https://docs.python.org/3/library/constants.html#None "None") to [`set_authorizer()`](https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.set_authorizer "sqlite3.Connection.set_authorizer"). Patch by Erlend E.