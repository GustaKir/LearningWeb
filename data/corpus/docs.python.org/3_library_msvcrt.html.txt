Title: msvcrt — Useful routines from the MS VC++ runtime
URL: https://docs.python.org/3/library/msvcrt.html
Summary: This document outlines the `msvcrt` Python library, which provides various routines and functionalities from Microsoft Visual C++ runtime, including file operations, console input/output, and other auxiliary functions.
---

[ ![Python logo](https://docs.python.org/3/_static/py.svg) ](https://www.python.org/) dev (3.14)3.13.33.123.113.103.93.83.73.63.53.43.33.23.13.02.72.6
EnglishSpanish | españolFrench | françaisItalian | italianoJapanese | 日本語Korean | 한국어Polish | polskiBrazilian Portuguese | Português brasileiroTurkish | TürkçeSimplified Chinese | 简体中文Traditional Chinese | 繁體中文
Theme  Auto Light Dark
### [Table of Contents](https://docs.python.org/3/contents.html)
  * [`msvcrt` — Useful routines from the MS VC++ runtime](https://docs.python.org/3/library/msvcrt.html)
    * [File Operations](https://docs.python.org/3/library/msvcrt.html#file-operations)
    * [Console I/O](https://docs.python.org/3/library/msvcrt.html#console-i-o)
    * [Other Functions](https://docs.python.org/3/library/msvcrt.html#other-functions)


#### Previous topic
[MS Windows Specific Services](https://docs.python.org/3/library/windows.html "previous chapter")
#### Next topic
[`winreg` — Windows registry access](https://docs.python.org/3/library/winreg.html "next chapter")
### This Page
  * [Report a Bug](https://docs.python.org/3/bugs.html)
  * [Show Source ](https://github.com/python/cpython/blob/main/Doc/library/msvcrt.rst)


### Navigation
  * [index](https://docs.python.org/3/genindex.html "General Index")
  * [modules](https://docs.python.org/3/py-modindex.html "Python Module Index") |
  * [next](https://docs.python.org/3/library/winreg.html "winreg — Windows registry access") |
  * [previous](https://docs.python.org/3/library/windows.html "MS Windows Specific Services") |
  * ![Python logo](https://docs.python.org/3/_static/py.svg)
  * [Python](https://www.python.org/) »
  * EnglishSpanish | españolFrench | françaisItalian | italianoJapanese | 日本語Korean | 한국어Polish | polskiBrazilian Portuguese | Português brasileiroTurkish | TürkçeSimplified Chinese | 简体中文Traditional Chinese | 繁體中文
dev (3.14)3.13.33.123.113.103.93.83.73.63.53.43.33.23.13.02.72.6
  * [3.13.3 Documentation](https://docs.python.org/3/index.html) » 
  * [The Python Standard Library](https://docs.python.org/3/library/index.html) »
  * [MS Windows Specific Services](https://docs.python.org/3/library/windows.html) »
  * [`msvcrt` — Useful routines from the MS VC++ runtime](https://docs.python.org/3/library/msvcrt.html)
  * | 
  * Theme  Auto Light Dark |


# `msvcrt` — Useful routines from the MS VC++ runtime[¶](https://docs.python.org/3/library/msvcrt.html#module-msvcrt "Link to this heading")
These functions provide access to some useful capabilities on Windows platforms. Some higher-level modules use these functions to build the Windows implementations of their services. For example, the [`getpass`](https://docs.python.org/3/library/getpass.html#module-getpass "getpass: Portable reading of passwords and retrieval of the userid.") module uses this in the implementation of the [`getpass()`](https://docs.python.org/3/library/getpass.html#module-getpass "getpass: Portable reading of passwords and retrieval of the userid.") function.
Further documentation on these functions can be found in the Platform API documentation.
The module implements both the normal and wide char variants of the console I/O api. The normal API deals only with ASCII characters and is of limited use for internationalized applications. The wide char API should be used where ever possible.
Changed in version 3.3: Operations in this module now raise [`OSError`](https://docs.python.org/3/library/exceptions.html#OSError "OSError") where [`IOError`](https://docs.python.org/3/library/exceptions.html#IOError "IOError") was raised.
## File Operations[¶](https://docs.python.org/3/library/msvcrt.html#file-operations "Link to this heading") 

msvcrt.locking(_fd_ , _mode_ , _nbytes_)[¶](https://docs.python.org/3/library/msvcrt.html#msvcrt.locking "Link to this definition")
    
Lock part of a file based on file descriptor _fd_ from the C runtime. Raises [`OSError`](https://docs.python.org/3/library/exceptions.html#OSError "OSError") on failure. The locked region of the file extends from the current file position for _nbytes_ bytes, and may continue beyond the end of the file. _mode_ must be one of the `LK_*` constants listed below. Multiple regions in a file may be locked at the same time, but may not overlap. Adjacent regions are not merged; they must be unlocked individually.
Raises an [auditing event](https://docs.python.org/3/library/sys.html#auditing) `msvcrt.locking` with arguments `fd`, `mode`, `nbytes`. 

msvcrt.LK_LOCK[¶](https://docs.python.org/3/library/msvcrt.html#msvcrt.LK_LOCK "Link to this definition")


msvcrt.LK_RLCK[¶](https://docs.python.org/3/library/msvcrt.html#msvcrt.LK_RLCK "Link to this definition")
    
Locks the specified bytes. If the bytes cannot be locked, the program immediately tries again after 1 second. If, after 10 attempts, the bytes cannot be locked, [`OSError`](https://docs.python.org/3/library/exceptions.html#OSError "OSError") is raised.