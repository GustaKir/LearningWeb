Title: Python Library Updates
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section outlines recent changes in the Python library, including bug fixes for CGIHTTPRequestHandler, improvements to the inspect module to correctly handle missing line numbers, and modifications to error handling in inspect.findsource().
---

### Library[¶](https://docs.python.org/3/whatsnew/changelog.html#id338 "Link to this heading")
  * [bpo-5054](https://bugs.python.org/issue?@action=redirect&bpo=5054): CGIHTTPRequestHandler.run_cgi() HTTP_ACCEPT improperly parsed. Replace the special purpose getallmatchingheaders with generic get_all method and add relevant tests.
Original Patch by Martin Panter. Modified by Senthil Kumaran.
  * [bpo-42562](https://bugs.python.org/issue?@action=redirect&bpo=42562): Fix issue when dis failed to parse function that has no line numbers. Patch provided by Yurii Karabas.
  * [bpo-17735](https://bugs.python.org/issue?@action=redirect&bpo=17735): `inspect.findsource()` now raises [`OSError`](https://docs.python.org/3/library/exceptions.html#OSError "OSError") instead of [`IndexError`](https://docs.python.org/3/library/exceptions.html#IndexError "IndexError") when `co_lineno` of a code object is greater than the file length. This can happen, for example, when a file is edited after it was imported. PR by Irit Katriel.
  * [bpo-42116](https://bugs.python.org/issue?@action=redirect&bpo=42116): Fix handling of trailing comments by [`inspect.getsource()`](https://docs.python.org/3/library/inspect.html#inspect.getsource "inspect.getsource").
  * [bpo-42532](https://bugs.python.org/issue?@action=redirect&bpo=42532): Remove unexpected call of `__bool__` when passing a `spec_arg` argument to a Mock.
  * [bpo-38200](https://bugs.python.org/issue?@action=redirect&bpo=38200): Added itertools.pairwise()
  * [bpo-41818](https://bugs.python.org/issue?@action=redirect&bpo=41818): Fix test_master_read() so that it succeeds on all platforms that either raise OSError or return b”” upon reading from master.
  * [bpo-42487](https://bugs.python.org/issue?@action=redirect&bpo=42487): ChainMap.__iter__ no longer calls __getitem__ on underlying maps
  * [bpo-42482](https://bugs.python.org/issue?@action=redirect&bpo=42482): [`TracebackException`](https://docs.python.org/3/library/traceback.html#traceback.TracebackException "traceback.TracebackException") no longer holds a reference to the exception’s traceback object. Consequently, instances of TracebackException for equivalent but non-equal exceptions now compare as equal.
  * [bpo-41818](https://bugs.python.org/issue?@action=redirect&bpo=41818): Make test_openpty() avoid unexpected success due to number of rows and/or number of columns being == 0.
  * [bpo-42392](https://bugs.python.org/issue?@action=redirect&bpo=42392): Remove loop parameter from `asyncio.subprocess` and `asyncio.tasks` functions. Patch provided by Yurii Karabas.
  * [bpo-42392](https://bugs.python.org/issue?@action=redirect&bpo=42392): Remove loop parameter from `asyncio.open_connection` and `asyncio.start_server` functions. Patch provided by Yurii Karabas.
  * [bpo-28468](https://bugs.python.org/issue?@action=redirect&bpo=28468): Add [`platform.freedesktop_os_release()`](https://docs.python.org/3/library/platform.html#platform.freedesktop_os_release "platform.freedesktop_os_release") function to parse freedesktop.org `os-release` files.
  * [bpo-42299](https://bugs.python.org/issue?@action=redirect&bpo=42299): Removed the `formatter` module, which was deprecated in Python 3.4. It is somewhat obsolete, little used, and not tested. It was originally scheduled to be removed in Python 3.6, but such removals were delayed until after Python 2.7 EOL. Existing users should copy whatever classes they use into their code. Patch by Donghee Na and and Terry J. Reedy.
  * [bpo-26131](https://bugs.python.org/issue?@action=redirect&bpo=26131): Deprecate zipimport.zipimporter.load_module() in favour of exec_module().
  * [bpo-41818](https://bugs.python.org/issue?@action=redirect&bpo=41818): Updated tests for the pty library. test_basic() has been changed to test_openpty(); this additionally checks if slave termios and slave winsize are being set properly by pty.openpty(). In order to add support for FreeBSD, NetBSD, OpenBSD, and Darwin, this also adds test_master_read(), which demonstrates that pty.spawn() should not depend on an OSError to exit from its copy loop.
  * [bpo-42392](https://bugs.python.org/issue?@action=redirect&bpo=42392): Remove loop parameter from `__init__` in all `asyncio.locks` and `asyncio.Queue` classes. Patch provided by Yurii Karabas.
  * [bpo-15450](https://bugs.python.org/issue?@action=redirect&bpo=15450): Make [`filecmp.dircmp`](https://docs.python.org/3/library/filecmp.html#filecmp.dircmp "filecmp.dircmp") respect subclassing. Now the [`filecmp.dircmp.subdirs`](https://docs.python.org/3/library/filecmp.html#filecmp.dircmp.subdirs "filecmp.dircmp.subdirs") behaves as expected when subclassing dircmp.
  * [bpo-42413](https://bugs.python.org/issue?@action=redirect&bpo=42413): The exception [`socket.timeout`](https://docs.python.org/3/library/socket.html#socket.timeout "socket.timeout") is now an alias of [`TimeoutError`](https://docs.python.org/3/library/exceptions.html#TimeoutError "TimeoutError").
  * [b