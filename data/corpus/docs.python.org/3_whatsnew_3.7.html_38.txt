Title: Python 3.7 Changes and Enhancements
URL: https://docs.python.org/3/whatsnew/3.7.html
Summary: This document outlines several updates in Python 3.7, including handling of non-file field values in `FieldStorage`, unreliability of `socket.fromshare()` with older versions, and modifications to the `repr` representation of `BaseException` which no longer includes a trailing comma.
---

ding_ and _errors_ arguments and returns the same results as `FieldStorage`: for non-file fields, the value associated to a key is a list of strings, not bytes. (Contributed by Pierre Quentel in [bpo-29979](https://bugs.python.org/issue?@action=redirect&bpo=29979).)
  * Due to internal changes in [`socket`](https://docs.python.org/3/library/socket.html#module-socket "socket: Low-level networking interface."), calling [`socket.fromshare()`](https://docs.python.org/3/library/socket.html#socket.fromshare "socket.fromshare") on a socket created by [`socket.share`](https://docs.python.org/3/library/socket.html#socket.socket.share "socket.socket.share") in older Python versions is not supported.
  * `repr` for [`BaseException`](https://docs.python.org/3/library/exceptions.html#BaseException "BaseException") has changed to not include the trailing comma. Most exceptions are affected by this change. (Contributed by Serhiy Storchaka in [bpo-30399](https://bugs.python.org/issue?@action=redirect&bpo=30399).)
  * `repr` for [`datetime.timedelta`](https://docs.python.org/3/library/datetime.html#datetime.timedelta "datetime.timedelta") has changed to include the keyword arguments in the output. (Contributed by Utkarsh Upadhyay in [bpo-30302](https://bugs.python.org/issue?@action=redirect&bpo=30302).)
  * Because [`shutil.rmtree()`](https://docs.python.org/3/library/shutil.html#shutil.rmtree "shutil.rmtree") is now implemented using the [`os.scandir()`](https://docs.python.org/3/library/os.html#os.scandir "os.scandir") function, the user specified handler _onerror_ is now called with the first argument `os.scandir` instead of `os.listdir` when listing the directory is failed.
  * Support for nested sets and set operations in regular expressions as in [Unicode Technical Standard #18](https://unicode.org/reports/tr18/) might be added in the future. This would change the syntax. To facilitate this future change a [`FutureWarning`](https://docs.python.org/3/library/exceptions.html#FutureWarning "FutureWarning") will be raised in ambiguous cases for the time being. That include sets starting with a literal `'['` or containing literal character sequences `'--'`, `'&&'`, `'~~'`, and `'||'`. To avoid a warning, escape them with a backslash. (Contributed by Serhiy Storchaka in [bpo-30349](https://bugs.python.org/issue?@action=redirect&bpo=30349).)
  * The result of splitting a string on a [`regular expression`](https://docs.python.org/3/library/re.html#module-re "re: Regular expression operations.") that could match an empty string has been changed. For example splitting on `r'\s*'` will now split not only on whitespaces as it did previously, but also on empty strings before all non-whitespace characters and just before the end of the string. The previous behavior can be restored by changing the pattern to `r'\s+'`. A [`FutureWarning`](https://docs.python.org/3/library/exceptions.html#FutureWarning "FutureWarning") was emitted for such patterns since Python 3.5.
For patterns that match both empty and non-empty strings, the result of searching for all matches may also be changed in other cases. For example in the string `'a\n\n'`, the pattern `r'(?m)^\s*?$'` will not only match empty strings at positions 2 and 3, but also the string `'\n'` at positions 2–3. To match only blank lines, the pattern should be rewritten as `r'(?m)^[^\S\n]*$'`.
[`re.sub()`](https://docs.python.org/3/library/re.html#re.sub "re.sub") now replaces empty matches adjacent to a previous non-empty match. For example `re.sub('x*', '-', 'abxd')` returns now `'-a-b--d-'` instead of `'-a-b-d-'` (the first minus between ‘b’ and ‘d’ replaces ‘x’, and the second minus replaces an empty string between ‘x’ and ‘d’).
(Contributed by Serhiy Storchaka in [bpo-25054](https://bugs.python.org/issue?@action=redirect&bpo=25054) and [bpo-32308](https://bugs.python.org/issue?@action=redirect&bpo=32308).)
  * Change [`re.escape()`](https://docs.python.org/3/library/re.html#re.escape "re.escape") to only escape regex special characters instead of escaping all characters other than ASCII letters, numbers, and `'_'`. (Contributed by Serhiy Storchaka in [bpo-29995](https://bugs.python.org/issue?@action=redirect&bpo=29995).)
  * [`tracemalloc.Traceback`](https://docs.python.org/3/library/tracemalloc.html#tracemalloc.Traceback "tracemalloc.Traceback") frames are now sorted from oldest to most recent to be more consistent with [`traceback`](https://docs.python.org/3/library/traceback.html#module-traceback "traceback: Print or retrieve a stack traceback.").