Title: Updates to Python Test Suite
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section details several updates to the Python test suite, including changes to ANSI code page encoding for Windows, fixes for repeated test failures, mitigation of race conditions in socket tests, and various bug fixes in specific test files.
---

### Tests[¶](https://docs.python.org/3/whatsnew/changelog.html#id209 "Link to this heading")
  * [gh-95027](https://github.com/python/cpython/issues/95027): On Windows, when the Python test suite is run with the `-jN` option, the ANSI code page is now used as the encoding for the stdout temporary file, rather than using UTF-8 which can lead to decoding errors. Patch by Victor Stinner.
  * [gh-96624](https://github.com/python/cpython/issues/96624): Fixed the failure of repeated runs of `test.test_unittest` caused by side effects in `test_dotted_but_module_not_loaded`.
  * [gh-95243](https://github.com/python/cpython/issues/95243): Mitigate the inherent race condition from using find_unused_port() in testSockName() by trying to find an unused port a few times before failing. Patch by Ross Burton.
  * [gh-95573](https://github.com/python/cpython/issues/95573): [Lib/test/test_asyncio/test_ssl.py](https://github.com/python/cpython/tree/3.13/Lib/test/test_asyncio/test_ssl.py) exposed a bug in the macOS kernel where intense concurrent load on non-blocking sockets occasionally causes [`errno.ENOBUFS`](https://docs.python.org/3/library/errno.html#errno.ENOBUFS "errno.ENOBUFS") (“No buffer space available”) to be emitted. FB11063974 filed with Apple, in the mean time as a workaround buffer size used in tests on macOS is decreased to avoid intermittent failures. Patch by Fantix King.
  * [gh-95280](https://github.com/python/cpython/issues/95280): Fix problem with `test_ssl` `test_get_ciphers` on systems that require perfect forward secrecy (PFS) ciphers.
  * [gh-95212](https://github.com/python/cpython/issues/95212): Make multiprocessing test case `test_shared_memory_recreate` parallel-safe.
  * [gh-95218](https://github.com/python/cpython/issues/95218): Move tests for importlib.resources into test_importlib.resources.
  * [gh-93963](https://github.com/python/cpython/issues/93963): Updated tests to use preferred location for `importlib.resources` ABCs.
  * [gh-94675](https://github.com/python/cpython/issues/94675): Add a regression test for [`re`](https://docs.python.org/3/library/re.html#module-re "re: Regular expression operations.") exponentional slowdown when using rjsmin.
  * [gh-91330](https://github.com/python/cpython/issues/91330): Added more tests for [`dataclasses`](https://docs.python.org/3/library/dataclasses.html#module-dataclasses "dataclasses: Generate special methods on user-defined classes.") to cover behavior with data descriptor-based fields.
  * [gh-94208](https://github.com/python/cpython/issues/94208): `test_ssl` is now checking for supported TLS version and protocols in more tests.
  * [gh-94315](https://github.com/python/cpython/issues/94315): Tests now check for DAC override capability instead of relying on [`os.geteuid()`](https://docs.python.org/3/library/os.html#os.geteuid "os.geteuid").
  * [gh-54781](https://github.com/python/cpython/issues/54781): Rename test_tk to test_tkinter, and rename test_ttk_guionly to test_ttk. Patch by Victor Stinner.
  * [gh-93839](https://github.com/python/cpython/issues/93839): Move `Lib/ctypes/test/` to `Lib/test/test_ctypes/`. Patch by Victor Stinner.
  * [gh-93951](https://github.com/python/cpython/issues/93951): In test_bdb.StateTestCase.test_skip, avoid including auxiliary importers.
  * [gh-93957](https://github.com/python/cpython/issues/93957): Provide nicer error reporting from subprocesses in test_venv.EnsurePipTest.test_with_pip.
  * [gh-93884](https://github.com/python/cpython/issues/93884): Add test cases for [`PyNumber_ToBase()`](https://docs.python.org/3/c-api/number.html#c.PyNumber_ToBase "PyNumber_ToBase") that take a large number or a non-int object as parameter.
  * [gh-93852](https://github.com/python/cpython/issues/93852): test_asyncio, test_logging, test_socket and test_socketserver now create AF_UNIX domains in the current directory to no longer fail with `OSError("AF_UNIX path too long")` if the temporary directory (the `TMPDIR` environment variable) is too long. Patch by Victor Stinner.
  * [gh-93353](https://github.com/python/cpython/issues/93353): regrtest now checks if a test leaks temporary files or directories if run with -jN option. Patch by Victor Stinner.
  * [gh-84461](https://github.com/python/cpython/issues/84461): `run_tests.py` now handles cross compiling env vars correctly and pass `HOSTRUNNER` to regression tests.
  * [gh-93616](https://github.com/python/cpython/issues/93616): `test_modulefinder` now creates a temporary directory in `ModuleFinderTest.setUp()` instead of module scope.
  * [gh-93575](https://github.com/python/cpython/issues/93575): Fix issue with test_unicode test_raiseMemError. The test case now use `test.support.calcobjsize` to calculate size of PyUnicode structs. [`sys.getsizeof()`](https://docs.python.org/3/library/sys.html#sys.getsizeof "sys.getsizeof") may return different size when string has UTF-8 memory.
  * [gh-90473](https://github.com/python/cpython/issues/90473): WASI does not have a `chmod(