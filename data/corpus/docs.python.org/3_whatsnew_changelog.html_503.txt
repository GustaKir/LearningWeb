Title: Updates to Testing Infrastructure
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: The latest changes in the testing framework include improved detection of uncollectable objects in regrtest, better error reporting in multiprocessing mode, and a modified approach for testing elapsed time to reduce false failures.
---

### Tests[Â¶](https://docs.python.org/3/whatsnew/changelog.html#id450 "Link to this heading")
  * [bpo-36719](https://bugs.python.org/issue?@action=redirect&bpo=36719): regrtest now always detects uncollectable objects. Previously, the check was only enabled by `--findleaks`. The check now also works with `-jN/--multiprocess N`. `--findleaks` becomes a deprecated alias to `--fail-env-changed`.
  * [bpo-36725](https://bugs.python.org/issue?@action=redirect&bpo=36725): When using multiprocessing mode (-jN), regrtest now better reports errors if a worker process fails, and it exits immediately on a worker thread failure or when interrupted.
  * [bpo-36454](https://bugs.python.org/issue?@action=redirect&bpo=36454): Change test_time.test_monotonic() to test only the lower bound of elapsed time after a sleep command rather than the upper bound. This prevents unnecessary test failures on slow buildbots. Patch by Victor Stinner.
  * [bpo-32424](https://bugs.python.org/issue?@action=redirect&bpo=32424): Improve test coverage for xml.etree.ElementTree. Patch by Gordon P. Hemsley.
  * [bpo-32424](https://bugs.python.org/issue?@action=redirect&bpo=32424): Fix typo in test_cyclic_gc() test for xml.etree.ElementTree. Patch by Gordon P. Hemsley.
  * [bpo-36635](https://bugs.python.org/issue?@action=redirect&bpo=36635): Add a new `_testinternalcapi` module to test the internal C API.
  * [bpo-36629](https://bugs.python.org/issue?@action=redirect&bpo=36629): Fix `test_imap4_host_default_value()` of `test_imaplib`: catch also [`errno.ENETUNREACH`](https://docs.python.org/3/library/errno.html#errno.ENETUNREACH "errno.ENETUNREACH") error.
  * [bpo-36611](https://bugs.python.org/issue?@action=redirect&bpo=36611): Fix `test_sys.test_getallocatedblocks()` when [`tracemalloc`](https://docs.python.org/3/library/tracemalloc.html#module-tracemalloc "tracemalloc: Trace memory allocations.") is enabled.
  * [bpo-36560](https://bugs.python.org/issue?@action=redirect&bpo=36560): Fix reference leak hunting in regrtest: compute also deltas (of reference count, allocated memory blocks, file descriptor count) during warmup, to ensure that everything is initialized before starting to hunt reference leaks.
  * [bpo-36565](https://bugs.python.org/issue?@action=redirect&bpo=36565): Fix reference hunting (`python3 -m test -R 3:3`) when Python has no built-in abc module.
  * [bpo-31904](https://bugs.python.org/issue?@action=redirect&bpo=31904): Port test_resource to VxWorks: skip tests cases setting RLIMIT_FSIZE and RLIMIT_CPU.
  * [bpo-31904](https://bugs.python.org/issue?@action=redirect&bpo=31904): Fix test_tabnanny on VxWorks: adjust ENOENT error message.
  * [bpo-36436](https://bugs.python.org/issue?@action=redirect&bpo=36436): Fix `_testcapi.pymem_buffer_overflow()`: handle memory allocation failure.
  * [bpo-31904](https://bugs.python.org/issue?@action=redirect&bpo=31904): Fix test_utf8_mode on VxWorks: Python always use UTF-8 on VxWorks.
  * [bpo-36341](https://bugs.python.org/issue?@action=redirect&bpo=36341): Fix tests that may fail with PermissionError upon calling bind() on AF_UNIX sockets.