Title: Python 3.13 Library Updates
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section outlines recent changes in Python 3.13, including the modification of the `_shallow` argument in `filecmp.dircmp` to be keyword-only, improvements to the `site.register_readline()` function, and a fix for the constructor of `ast` nodes that addresses a previous `DeprecationWarning` when using custom attributes.
---

### Library[¶](https://docs.python.org/3/whatsnew/changelog.html#id56 "Link to this heading")
  * [gh-57141](https://github.com/python/cpython/issues/57141): The _shallow_ argument to [`filecmp.dircmp`](https://docs.python.org/3/library/filecmp.html#filecmp.dircmp "filecmp.dircmp") (new in Python 3.13) is now keyword-only.
  * [gh-121245](https://github.com/python/cpython/issues/121245): Simplify handling of the history file in `site.register_readline()` helper. The `CAN_USE_PYREPL` variable now will be initialized, when imported. Patch by Sergey B Kirpichev.
  * [gh-121332](https://github.com/python/cpython/issues/121332): Fix constructor of [`ast`](https://docs.python.org/3/library/ast.html#module-ast "ast: Abstract Syntax Tree classes and manipulation.") nodes with custom `_attributes`. Previously, passing custom attributes would raise a [`DeprecationWarning`](https://docs.python.org/3/library/exceptions.html#DeprecationWarning "DeprecationWarning"). Passing arguments to the constructor that are not in `_fields` or `_attributes` remains deprecated. Patch by Jelle Zijlstra.
  * [gh-121279](https://github.com/python/cpython/issues/121279): Avoid [`NameError`](https://docs.python.org/3/library/exceptions.html#NameError "NameError") for the [`warnings`](https://docs.python.org/3/library/warnings.html#module-warnings "warnings: Issue warning messages and control their disposition.") module when accessing the depracated atributes of the [`importlib.abc`](https://docs.python.org/3/library/importlib.html#module-importlib.abc "importlib.abc: Abstract base classes related to import") module.
  * [gh-121245](https://github.com/python/cpython/issues/121245): Fix a bug in the handling of the command history of the new [REPL](https://docs.python.org/3/glossary.html#term-REPL) that caused the history file to be wiped at REPL exit.
  * [gh-87744](https://github.com/python/cpython/issues/87744): Fix waitpid race while calling [`send_signal()`](https://docs.python.org/3/library/asyncio-subprocess.html#asyncio.subprocess.Process.send_signal "asyncio.subprocess.Process.send_signal") in asyncio. Patch by Kumar Aditya.
  * [gh-121018](https://github.com/python/cpython/issues/121018): Fixed other issues where [`argparse.ArgumentParser`](https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser "argparse.ArgumentParser") did not honor `exit_on_error=False`.
  * [gh-120678](https://github.com/python/cpython/issues/120678): Fix regression in the new REPL that meant that globals from files passed using the `-i` argument would not be included in the REPL’s global namespace. Patch by Alex Waygood.
  * [gh-120782](https://github.com/python/cpython/issues/120782): Fix wrong references of the [`datetime`](https://docs.python.org/3/library/datetime.html#module-datetime "datetime: Basic date and time types.") types after reloading the module.
  * [gh-120713](https://github.com/python/cpython/issues/120713): [`datetime.datetime.strftime()`](https://docs.python.org/3/library/datetime.html#datetime.datetime.strftime "datetime.datetime.strftime") now 0-pads years with less than four digits for the format specifiers `%Y` and `%G` on Linux. Patch by Ben Hsing
  * [gh-117983](https://github.com/python/cpython/issues/117983): Defer the `threading` import in `importlib.util` until lazy loading is used.
  * [gh-119189](https://github.com/python/cpython/issues/119189): When using the `**` operator or [`pow()`](https://docs.python.org/3/library/functions.html#pow "pow") with [`Fraction`](https://docs.python.org/3/library/fractions.html#fractions.Fraction "fractions.Fraction") as the base and an exponent that is not rational, a float, or a complex, the fraction is no longer converted to a float.
  * [gh-118714](https://github.com/python/cpython/issues/118714): Allow `restart` in post-mortem debugging of [`pdb`](https://docs.python.org/3/library/pdb.html#module-pdb "pdb: The Python debugger for interactive interpreters."). Removed restart message when the user quits pdb from post-mortem mode.
  * [gh-105623](https://github.com/python/cpython/issues/105623): Fix performance degradation in [`logging.handlers.RotatingFileHandler`](https://docs.python.org/3/library/logging.handlers.html#logging.handlers.RotatingFileHandler "logging.handlers.RotatingFileHandler"). Patch by Craig Robson.


### IDLE[¶](https://docs.python.org/3/whatsnew/changelog.html#id57 "Link to this heading")
  * [gh-78889](https://github.com/python/cpython/issues/78889): Stop Shell freezes by blocking user access to non-method sys.stdout.shell attributes, which are all private.