Title: Python 3 Library Changes
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This section outlines various updates to Python's standard library, including fixes to os.scandir() for bytes path support on Windows, improvements to the disassembler's FORMAT_VALUE argument, corrections in ZIP file writing, enhancements to Mock functionalities in unittest.mock, and the removal of statistics.geometric_mean until a later version.
---

### Library[¶](https://docs.python.org/3/whatsnew/changelog.html#id655 "Link to this heading")
  * [bpo-27998](https://bugs.python.org/issue?@action=redirect&bpo=27998): Fixed bytes path support in os.scandir() on Windows. Patch by Eryk Sun.
  * [bpo-28317](https://bugs.python.org/issue?@action=redirect&bpo=28317): The disassembler now decodes FORMAT_VALUE argument.
  * [bpo-26293](https://bugs.python.org/issue?@action=redirect&bpo=26293): Fixed writing ZIP files that starts not from the start of the file. Offsets in ZIP file now are relative to the start of the archive in conforming to the specification.
  * [bpo-28380](https://bugs.python.org/issue?@action=redirect&bpo=28380): unittest.mock Mock autospec functions now properly support assert_called, assert_not_called, and assert_called_once.
  * [bpo-27181](https://bugs.python.org/issue?@action=redirect&bpo=27181): remove statistics.geometric_mean and defer until 3.7.
  * [bpo-28229](https://bugs.python.org/issue?@action=redirect&bpo=28229): lzma module now supports pathlib.
  * [bpo-28321](https://bugs.python.org/issue?@action=redirect&bpo=28321): Fixed writing non-BMP characters with binary format in plistlib.
  * [bpo-28225](https://bugs.python.org/issue?@action=redirect&bpo=28225): bz2 module now supports pathlib. Initial patch by Ethan Furman.
  * [bpo-28227](https://bugs.python.org/issue?@action=redirect&bpo=28227): gzip now supports pathlib. Patch by Ethan Furman.
  * [bpo-27358](https://bugs.python.org/issue?@action=redirect&bpo=27358): Optimized merging var-keyword arguments and improved error message when passing a non-mapping as a var-keyword argument.
  * [bpo-28257](https://bugs.python.org/issue?@action=redirect&bpo=28257): Improved error message when passing a non-iterable as a var-positional argument. Added opcode BUILD_TUPLE_UNPACK_WITH_CALL.
  * [bpo-28322](https://bugs.python.org/issue?@action=redirect&bpo=28322): Fixed possible crashes when unpickle itertools objects from incorrect pickle data. Based on patch by John Leitch.
  * [bpo-28228](https://bugs.python.org/issue?@action=redirect&bpo=28228): imghdr now supports pathlib.
  * [bpo-28226](https://bugs.python.org/issue?@action=redirect&bpo=28226): compileall now supports pathlib.
  * [bpo-28314](https://bugs.python.org/issue?@action=redirect&bpo=28314): Fix function declaration (C flags) for the getiterator() method of xml.etree.ElementTree.Element.
  * [bpo-28148](https://bugs.python.org/issue?@action=redirect&bpo=28148): Stop using localtime() and gmtime() in the time module. Introduced platform independent _PyTime_localtime API that is similar to POSIX localtime_r, but available on all platforms. Patch by Ed Schouten.
  * [bpo-28253](https://bugs.python.org/issue?@action=redirect&bpo=28253): Fixed calendar functions for extreme months: 0001-01 and 9999-12. Methods itermonthdays() and itermonthdays2() are reimplemented so that they don’t call itermonthdates() which can cause datetime.date under/overflow.
  * [bpo-28275](https://bugs.python.org/issue?@action=redirect&bpo=28275): Fixed possible use after free in the decompress() methods of the LZMADecompressor and BZ2Decompressor classes. Original patch by John Leitch.
  * [bpo-27897](https://bugs.python.org/issue?@action=redirect&bpo=27897): Fixed possible crash in sqlite3.Connection.create_collation() if pass invalid string-like object as a name. Patch by Xiang Zhang.
  * [bpo-18844](https://bugs.python.org/issue?@action=redirect&bpo=18844): random.choices() now has k as a keyword-only argument to improve the readability of common cases and come into line with the signature used in other languages.
  * [bpo-18893](https://bugs.python.org/issue?@action=redirect&bpo=18893): Fix invalid exception handling in Lib/ctypes/macholib/dyld.py. Patch by Madison May.
  * [bpo-27611](https://bugs.python.org/issue?@action=redirect&bpo=27611): Fixed support of default root window in the tkinter.tix module. Added the master parameter in the DisplayStyle constructor.
  * [bpo-27348](https://bugs.python.org/issue?@action=redirect&bpo=27348): In the traceback module, restore the formatting of exception messages like “Exception: None”. This fixes a regression introduced in 3.5a2.
  * [bpo-25651](https://bugs.python.org/issue?@action=redirect&bpo=25651): Allow false values to be used for msg parameter of subTest().
  * [bpo-27778](https://bugs.python.org/issue?@action=redirect&bpo=27778): Fix a memory leak in os.getrandom() when the getrandom() is interrupted by a signal and a signal handler raises a Python exception.
  * [bpo-28200](https://bugs.python.org/issue?@action=redirect&bpo=28200): Fix memory leak on Windows in the os module (fix path_converter() function).
  * [bpo-25400](https://bugs.python.org/issue?@action=redirect&bpo=25400): RobotFileParser now correctly returns default values for crawl_delay and request_rate. Initial patch by Peter Wirtz.
  * [bpo-27932](https://bugs.python.org/issue?@action=redirect&bpo=27932): Prevent memory leak i