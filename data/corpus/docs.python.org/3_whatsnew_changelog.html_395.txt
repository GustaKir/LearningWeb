Title: Python 3 Changelog Highlights
URL: https://docs.python.org/3/whatsnew/changelog.html
Summary: This document outlines key changes and improvements made in Python 3, including updates to the `shelve` module to use `pickle.DEFAULT_PROTOCOL` by default, a fix for a KeyError in email flattening, and enhancements to the `http.cookiejar` module's capabilities.
---

PR by Anthony Sottile.
  * [bpo-34204](https://bugs.python.org/issue?@action=redirect&bpo=34204): The [`shelve`](https://docs.python.org/3/library/shelve.html#module-shelve "shelve: Python object persistence.") module now uses [`pickle.DEFAULT_PROTOCOL`](https://docs.python.org/3/library/pickle.html#pickle.DEFAULT_PROTOCOL "pickle.DEFAULT_PROTOCOL") by default instead of [`pickle`](https://docs.python.org/3/library/pickle.html#module-pickle "pickle: Convert Python objects to streams of bytes and back.") protocol `3`.
  * [bpo-27321](https://bugs.python.org/issue?@action=redirect&bpo=27321): Fixed KeyError exception when flattening an email to a string attempts to replace a non-existent Content-Transfer-Encoding header.
  * [bpo-38976](https://bugs.python.org/issue?@action=redirect&bpo=38976): The [`http.cookiejar`](https://docs.python.org/3/library/http.cookiejar.html#module-http.cookiejar "http.cookiejar: Classes for automatic handling of HTTP cookies.") module now supports the parsing of cookies in CURL-style cookiejar files through MozillaCookieJar on all platforms. Previously, such cookie entries would be silently ignored when loading a cookiejar with such entries.
Additionally, the HTTP Only attribute is persisted in the object, and will be correctly written to file if the MozillaCookieJar object is subsequently dumped.


### Documentation[¶](https://docs.python.org/3/whatsnew/changelog.html#id350 "Link to this heading")
  * [bpo-42061](https://bugs.python.org/issue?@action=redirect&bpo=42061): Document __format__ functionality for IP addresses.
  * [bpo-41910](https://bugs.python.org/issue?@action=redirect&bpo=41910): Document the default implementation of `object.__eq__`.
  * [bpo-42010](https://bugs.python.org/issue?@action=redirect&bpo=42010): Clarify that subscription expressions are also valid for certain [classes](https://docs.python.org/3/glossary.html#term-class) and [types](https://docs.python.org/3/glossary.html#term-type) in the standard library, and for user-defined classes and types if the classmethod `__class_getitem__()` is provided.
  * [bpo-41805](https://bugs.python.org/issue?@action=redirect&bpo=41805): Documented [generic alias type](https://docs.python.org/3/library/stdtypes.html#types-genericalias) and [`types.GenericAlias`](https://docs.python.org/3/library/types.html#types.GenericAlias "types.GenericAlias"). Also added an entry in glossary for [generic types](https://docs.python.org/3/glossary.html#term-generic-type).
  * [bpo-39693](https://bugs.python.org/issue?@action=redirect&bpo=39693): Fix tarfile’s extractfile documentation
  * [bpo-39416](https://bugs.python.org/issue?@action=redirect&bpo=39416): Document some restrictions on the default string representations of numeric classes.


### Tests[¶](https://docs.python.org/3/whatsnew/changelog.html#id351 "Link to this heading")
  * [bpo-41739](https://bugs.python.org/issue?@action=redirect&bpo=41739): Fix test_logging.test_race_between_set_target_and_flush(): the test now waits until all threads complete to avoid leaking running threads.
  * [bpo-41970](https://bugs.python.org/issue?@action=redirect&bpo=41970): Avoid a test failure in `test_lib2to3` if the module has already imported at the time the test executes. Patch by Pablo Galindo.
  * [bpo-41944](https://bugs.python.org/issue?@action=redirect&bpo=41944): Tests for CJK codecs no longer call `eval()` on content received via HTTP.
  * [bpo-41306](https://bugs.python.org/issue?@action=redirect&bpo=41306): Fixed a failure in `test_tk.test_widgets.ScaleTest` happening when executing the test with Tk 8.6.10.


### Build[¶](https://docs.python.org/3/whatsnew/changelog.html#id352 "Link to this heading")
  * [bpo-38980](https://bugs.python.org/issue?@action=redirect&bpo=38980): Add `-fno-semantic-interposition` to both the compile and link line when building with `--enable-optimizations`. Patch by Victor Stinner and Pablo Galindo.


### Windows[¶](https://docs.python.org/3/whatsnew/changelog.html#id353 "Link to this heading")
  * [bpo-38439](https://bugs.python.org/issue?@action=redirect&bpo=38439): Updates the icons for IDLE in the Windows Store package.
  * [bpo-38252](https://bugs.python.org/issue?@action=redirect&bpo=38252): Use 8-byte step to detect ASCII sequence in 64-bit Windows build.
  * [bpo-39107](https://bugs.python.org/issue?@action=redirect&bpo=39107): Update Tcl and Tk to 8.6.10 in Windows installer.
  * [bpo-41557](https://bugs.python.org/issue?@action=redirect&bpo=41557): Update Windows installer to use SQLite 3.33.0.
  * [bpo-38324](https://bugs.python.org/issue?@action=redirect&bpo=38324): Avoid Unicode errors when accessing certain locale data on Windows.


### macOS[¶](https://docs.python.org/3/whatsnew/changelog.html#id354 "Link to this heading")
  * [bpo-41471](https://bugs.python.org/issue?@action=redirect&bpo=41471): Ignore invalid prefix lengths in system proxy excludes.