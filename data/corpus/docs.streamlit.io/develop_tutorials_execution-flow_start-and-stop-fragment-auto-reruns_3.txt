Title: Building a Fragment Function to Stream Data in Streamlit
URL: https://docs.streamlit.io/develop/tutorials/execution-flow/start-and-stop-fragment-auto-reruns
Summary: This section explains how to create a fragment function in Streamlit to enable data streaming by utilizing the `@st.fragment()` decorator with the `run_every` parameter. It includes a sample function to show and stream data, demonstrating how to manage the state and visualize streamed data using line charts.
---

### [](https://docs.streamlit.io/develop/tutorials/execution-flow/start-and-stop-fragment-auto-reruns#build-a-fragment-function-to-stream-data)Build a fragment function to stream data
To allow the user to turn data streaming on and off, you must set the `run_every` parameter in the `@st.fragment()` decorator.
Complete function to show and stream data _expand_more_
`@st.fragment(run_every=run_every) def show_latest_data():   last_timestamp = st.session_state.data.index[-1]   st.session_state.data = pd.concat( [st.session_state.data, get_recent_data(last_timestamp)] )   st.session_state.data = st.session_state.data[-100:]   st.line_chart(st.session_state.data) `
  1. Use an [`@st.fragment`](https://docs.streamlit.io/develop/api-reference/execution-flow/st.fragment) decorator and start your function definition.
` @st.fragment(run_every=run_every) def show_latest_data(): `
Use the `run_every` variable declared above to set the parameter of the same name.
  2. Retrieve the timestamp of the last datapoint in Session State.
`  last_timestamp = st.session_state.data.index[-1] `
  3. Update the data in Session State and trim to keep only the last 100 timestamps.
`  st.session_state.data = pd.concat( [st.session_state.data, get_recent_data(last_timestamp)] )   st.session_state.data = st.session_state.data[-100:] `
  4. Show the data in a line chart.
`  st.line_chart(st.session_state.data) `
Your fragment-function definition is complete.


### [](https://docs.streamlit.io/develop/tutorials/execution-flow/start-and-stop-fragment-auto-reruns#call-and-test-out-your-fragment-function)Call and test out your fragment function
  1. Call your function at the bottom of your code.
`show_latest_data() `
  2. Test out your app by clicking "**Start streaming**." Try adjusting the frequency of updates.


## [](https://docs.streamlit.io/develop/tutorials/execution-flow/start-and-stop-fragment-auto-reruns#next-steps)Next steps
Try adjusting the frequency of data generation or how much data is kept in Session State. Within `get_recent_data` try setting `sample_time` with a widget.
Try using [st.plotly_chart](https://docs.streamlit.io/develop/api-reference/charts/st.plotly_chart) or [st.altair_chart](https://docs.streamlit.io/develop/api-reference/charts/st.altair_chart) to add labels to your chart.
[Previous: Create a multiple-container fragment](https://docs.streamlit.io/develop/tutorials/execution-flow/create-a-multiple-container-fragment)[Next: Connect to data sources](https://docs.streamlit.io/develop/tutorials/databases) _forum_
### Still have questions?
Our [forums](https://discuss.streamlit.io) are full of helpful information and Streamlit experts.
[Home](https://docs.streamlit.io/)Contact Us[Community](https://discuss.streamlit.io)[](https://github.com/streamlit "GitHub")[](https://www.youtube.com/channel/UC3LD42rjj-Owtxsa6PwGU5Q "YouTube")[](https://twitter.com/streamlit "Twitter")[](https://www.linkedin.com/company/streamlit "LinkedIn")[](https://info.snowflake.com/streamlit-newsletter-sign-up.html "Newsletter")
Â© 2025 Snowflake Inc.Cookie policy
 _forum_ Ask AI