Title: Working with Private Google Sheets in Streamlit
URL: https://docs.streamlit.io/develop/tutorials/databases/private-gsheet
Summary: This tutorial outlines the process of integrating a private Google Sheet with a Streamlit app, covering key steps such as creating a Google Sheet, enabling the Sheets API, setting up a service account, sharing the sheet with the service account, and adding the required key file to app secrets.
---

1. Contents
  2. [Introduction](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#introduction)
  3. [Prerequisites](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#prerequisites)
  4. [Create a Google Sheet](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#create-a-google-sheet)
  5. [Enable the Sheets API](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#enable-the-sheets-api)
  6. [Create a service account & key file](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#create-a-service-account--key-file)
  7. [Share the Google Sheet with the service account](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#share-the-google-sheet-with-the-service-account)
  8. [Add the key file to your local app secrets](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#add-the-key-file-to-your-local-app-secrets)
  9. [Write your Streamlit app](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#write-your-streamlit-app)
  10. [Connecting to a Google Sheet from Community Cloud](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#connecting-to-a-google-sheet-from-community-cloud)


# [](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#connect-streamlit-to-a-private-google-sheet)Connect Streamlit to a private Google Sheet
## [](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#introduction)Introduction
This guide explains how to securely access a private Google Sheet from Streamlit Community Cloud. It uses [st.connection](https://docs.streamlit.io/develop/api-reference/connections/st.connection), [Streamlit GSheetsConnection](https://github.com/streamlit/gsheets-connection), and Streamlit's [Secrets management](https://docs.streamlit.io/develop/concepts/connections/secrets-management).
If you are fine with enabling link sharing for your Google Sheet (i.e. everyone with the link can view it), the guide [Connect Streamlit to a public Google Sheet](https://docs.streamlit.io/develop/tutorials/databases/public-gsheet) shows a simpler method of doing this. If your Sheet contains sensitive information and you cannot enable link sharing, keep on reading.
### [](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#prerequisites)Prerequisites
This tutorial requires `streamlit>=1.28` and `st-gsheets-connection` in your Python environment.
## [](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#create-a-google-sheet)Create a Google Sheet
If you already have a Sheet that you want to use, you can [skip to the next step](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#enable-the-sheets-api).
Create a spreadsheet with this example data.
name| pet  
---|---  
Mary| dog  
John| cat  
Robert| bird  
![Google sheet screenshot](https://docs.streamlit.io/images/databases/private-gsheet-1.png)
## [](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#enable-the-sheets-api)Enable the Sheets API
Programmatic access to Google Sheets is controlled through [Google Cloud Platform](https://cloud.google.com/). Create an account or sign in and head over to the [**APIs & Services** dashboard](https://console.cloud.google.com/apis/dashboard) (select or create a project if asked). As shown below, search for the Sheets API and enable it:
![GCP screenshot 1](https://docs.streamlit.io/images/databases/private-gsheet-2.png)![GCP screenshot 2](https://docs.streamlit.io/images/databases/private-gsheet-3.png)![GCP screenshot 3](https://docs.streamlit.io/images/databases/private-gsheet-4.png)
## [](https://docs.streamlit.io/develop/tutorials/databases/private-gsheet#create-a-service-account--key-file)Create a service account & key file
To use the Sheets API from Streamlit Community Cloud, you need a Google Cloud Platform service account (a special account type for programmatic data access). Go to the [**Service Accounts** page](https://console.cloud.google.com/iam-admin/serviceaccounts) and create an account with the **Viewer** permission (this will let the account access data but not change it):
![GCP screenshot 5](https://docs.streamlit.io/images/databases/private-gsheet-5.png)![GCP screenshot 6](https://docs.streamlit.io/images/databases/private-gsheet-6.png)![GCP screenshot 7](https://docs.streamlit.io/images/databases/private-gsheet-7.png) _push_pin_
#### Note
The button "**CREATE SERVICE ACCOUNT** " is gray, you don't have the correct permissions. Ask the admin of your Google Cloud project for help.
After clicking "**DONE** ", you should be back on the service accounts overview. First, note down the email address of the account you just created (**important for next step!**). Then, create a JSON key file for the new account and download it:
![GCP screenshot 8](https://docs.streamlit.io/images/databases/private-gsheet-8.png)![GCP screenshot 9](https://docs.streamlit.io/images/data