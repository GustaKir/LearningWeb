Title: Streamlit SnowparkConnection API Reference
URL: https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection
Summary: This document provides an overview of the `st.connections.SnowparkConnection` class in Streamlit, including its methods such as `query`, `reset`, `safe_session`, and `session` to manage data connections effectively.
---

1. Contents
  2. [st.connections.SnowparkConnection](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#stconnectionssnowparkconnection)
  3. [SnowparkConnection.query](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionquery)
  4. [SnowparkConnection.reset](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionreset)
  5. [SnowparkConnection.safe_session](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionsafe_session)
  6. [SnowparkConnection.session](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionsession)


 _star_
#### Tip
This page only contains the `st.connections.SnowparkConnection` class. For a deeper dive into creating and managing data connections within Streamlit apps, read [Connecting to data](https://docs.streamlit.io/develop/concepts/connections/connecting-to-data).
## [](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#stconnectionssnowparkconnection)st.connections.SnowparkConnection
Streamlit VersionVersion 1.44.0Version 1.43.0Version 1.42.0Version 1.41.0Version 1.40.0Version 1.39.0Version 1.38.0Version 1.37.0Version 1.36.0Version 1.35.0Version 1.34.0Version 1.33.0Version 1.32.0Version 1.31.0Version 1.30.0Version 1.29.0Version 1.28.0Version 1.27.0Version 1.26.0Version 1.25.0Version 1.24.0Version 1.23.0Version 1.22.0Version 1.21.0Version 1.20.0
 _delete_
#### Deprecation notice
`st.connections.SnowParkConnection` was deprecated in version 1.28.0. Use [`st.connections.SnowflakeConnection`](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowflakeconnection) instead.
A connection to Snowpark using snowflake.snowpark.session.Session. Initialize using
`st.connection("<name>", type="snowpark")`.
In addition to providing access to the Snowpark Session, SnowparkConnection supports direct SQL querying using `query("...")` and thread safe access using `with conn.safe_session():`. See methods below for more information. SnowparkConnections should always be created using `st.connection()`, **not** initialized directly.
Note
We don't expect this iteration of SnowparkConnection to be able to scale well in apps with many concurrent users due to the lock contention that will occur over the single underlying Session object under high load.
Class description[[source]](https://github.com/streamlit/streamlit/blob/1.44.0/lib/streamlit/connections/snowpark_connection.py#L48 "View st.SnowparkConnection source code on GitHub")  
---  
st.connections.SnowparkConnection(connection_name, **kwargs)  
Methods  
[query](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionquery)(sql, ttl=None) |  Run a read-only SQL query.  
[reset](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionreset)() |  Reset this connection so that it gets reinitialized the next time it's used.  
[safe_session](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionsafe_session)() |  Grab the underlying Snowpark session in a thread-safe manner.  
Attributes  
[session ](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionsession) |  Access the underlying Snowpark session.  
## [](https://docs.streamlit.io/develop/api-reference/connections/st.connections.snowparkconnection#snowparkconnectionquery)SnowparkConnection.query
Streamlit VersionVersion 1.44.0Version 1.43.0Version 1.42.0Version 1.41.0Version 1.40.0Version 1.39.0Version 1.38.0Version 1.37.0Version 1.36.0Version 1.35.0Version 1.34.0Version 1.33.0Version 1.32.0Version 1.31.0Version 1.30.0Version 1.29.0Version 1.28.0Version 1.27.0Version 1.26.0Version 1.25.0Version 1.24.0Version 1.23.0Version 1.22.0Version 1.21.0Version 1.20.0
Run a read-only SQL query.
This method implements both query result caching (with caching behavior identical to that of using `@st.cache_data`) as well as simple error handling/retries.
Note
Queries that are run without a specified ttl are cached indefinitely.
Function signature[[source]](https://github.com/streamlit/streamlit/blob/1.44.0/lib/streamlit/connections/snowpark_connection.py#L96 "View st.query source code on GitHub")  
---  
SnowparkConnection.query(sql, ttl=None)  
Parameters  
sql (str) |  The read-only SQL query to execute.  
ttl (float, int, timedelta or None) |  The maximum number of seconds to keep results in the cache, or None if cached results should not expire. The default is None.  
Returns  
(pandas.DataFrame) | The result of running the query, formatted as a pandas DataFrame.  
#### Example